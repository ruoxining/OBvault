
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ruoxining.github.io/OBvault/CS/OS/lab/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../../CA/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.18">
    
    
      
        <title>lab - Mini Babel Library</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../_css/style.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#os-lab" class="md-skip">
          Ë∑≥ËΩ¨Ëá≥
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="È°µÁúâ">
    <a href="../../.." title="Mini Babel Library" class="md-header__button md-logo" aria-label="Mini Babel Library" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mini Babel Library
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              lab
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="ÊêúÁ¥¢" placeholder="ÊêúÁ¥¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Êü•Êâæ">
        
        <button type="reset" class="md-search__icon md-icon" title="Ê∏ÖÁ©∫ÂΩìÂâçÂÜÖÂÆπ" aria-label="Ê∏ÖÁ©∫ÂΩìÂâçÂÜÖÂÆπ" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Ê≠£Âú®ÂàùÂßãÂåñÊêúÁ¥¢ÂºïÊìé
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ruoxining/OBvault" title="ÂâçÂæÄ‰ªìÂ∫ì" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OBvault
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="ÂØºËà™Ê†è" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Mini Babel Library" class="md-nav__button md-logo" aria-label="Mini Babel Library" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Mini Babel Library
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ruoxining/OBvault" title="ÂâçÂæÄ‰ªìÂ∫ì" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OBvault
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        üèõÔ∏èüìö Mini Babel Library
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          üíªCS‰∏ìÊ†è
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          üíªCS‰∏ìÊ†è
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        Á¥¢Âºï
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../libgraphics/" class="md-nav__link">
        CÂ§ßÁ®ãlibgraphics
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
      
      
      
        <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          C++ÊåÅÁª≠ËøõÊ≠•
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          C++ÊåÅÁª≠ËøõÊ≠•
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CPP/course/" class="md-nav__link">
        ZJUÂê¨ËØæ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CPP/final_review/" class="md-nav__link">
        ZJUÊúüÊú´Â§ç‰π†
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../x86assm/" class="md-nav__link">
        x86Ê±áÁºñ
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
          OSÊìç‰ΩúÁ≥ªÁªü
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          OSÊìç‰ΩúÁ≥ªÁªü
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        index
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          lab
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        lab
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="ÁõÆÂΩï">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ÁõÆÂΩï
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    ËÉåÊôØÁü•ËØÜ
  </a>
  
    <nav class="md-nav" aria-label="ËÉåÊôØÁü•ËØÜ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    ÁâπÊùÉÊ®°Âºè
  </a>
  
    <nav class="md-nav" aria-label="ÁâπÊùÉÊ®°Âºè">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#os" class="md-nav__link">
    ËÆ°ÁÆóÊú∫‰∏äÁîµÂà∞OSËøêË°åÁöÑËøáÁ®ã
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sbiopensbi" class="md-nav__link">
    sbiÂíåopensbi
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    ÁéØÂ¢ÉÈÖçÁΩÆ
  </a>
  
    <nav class="md-nav" aria-label="ÁéØÂ¢ÉÈÖçÁΩÆ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    Docker
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker_1" class="md-nav__link">
    ËÅ™ÊòéÂú∞‰ΩøÁî®docker
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    ÊñπÊ≥ï‰ªãÁªç
  </a>
  
    <nav class="md-nav" aria-label="ÊñπÊ≥ï‰ªãÁªç">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qemu-gdb" class="md-nav__link">
    qemu + gdb Ë∞ÉËØï
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gdb" class="md-nav__link">
    ËÅ™ÊòéÂú∞‰ΩøÁî® gdb
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab0" class="md-nav__link">
    lab0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab1" class="md-nav__link">
    lab1
  </a>
  
    <nav class="md-nav" aria-label="lab1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#c-risc-v" class="md-nav__link">
    C &amp; RISC-V ÂÜÖËÅîÊ±áÁºñ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    ÁºñËØëÁöÑÁü•ËØÜ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#risc-v" class="md-nav__link">
    RISC-V Êó∂Èíü‰∏≠Êñ≠
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#riscv" class="md-nav__link">
    RISCV ÂØÑÂ≠òÂô®
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sv39" class="md-nav__link">
    Sv39 ÁöÑÈ°µË°®È°π
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    Âú∞ÂùÄÁøªËØëËøáÁ®ã
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heads-todo-va2pa_offset" class="md-nav__link">
    ‰∏∫‰ªÄ‰πàÂú® head.S Èáå‰∏ÄÂºÄÂßãË¶ÅÁªôÈ°µË°®È°πÂú∞ÂùÄ (TODOÂùè‰∫Ü‰∏çËÆ∞ÂæóÊòØ‰∏çÊòØÂÆÉ‰∫Ü) ÂáèÂéª‰∏Ä‰∏™ VA2PA_offset
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab4" class="md-nav__link">
    lab4
  </a>
  
    <nav class="md-nav" aria-label="lab4">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    Êõ¥Êñ∞ÂêéÁöÑËôöÊãüÂÜÖÂ≠òÂ∏ÉÂ±Ä
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab5" class="md-nav__link">
    lab5
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab6" class="md-nav__link">
    lab6
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab7" class="md-nav__link">
    lab7
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    Â∏∏ËßÅÈóÆÈ¢ò‰πãË°•ÂÖÖÂèàÂêçÊàë‰πãÊÄªÊòØÈÅáËßÅÈóÆÈ¢ò
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6" >
      
      
      
        <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
          CA‰ΩìÁ≥ªÁªìÊûÑ
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          CA‰ΩìÁ≥ªÁªìÊûÑ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CA/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CA/chap2/" class="md-nav__link">
        chap2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CA/chap3/" class="md-nav__link">
        chap3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CA/chap5/" class="md-nav__link">
        chap5
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          üéìDL‰∏ìÊ†è
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          üéìDL‰∏ìÊ†è
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../DL/" class="md-nav__link">
        Á¥¢Âºï
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
      
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          NLP Theory
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          NLP Theory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../DL/NLPTheory/explainable_nlp/" class="md-nav__link">
        Explainable NLP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../DL/NLPTheory/mwp/" class="md-nav__link">
        Math Word Problem
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          üå≥Ling‰∏ìÊ†è
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          üå≥Ling‰∏ìÊ†è
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Ling/" class="md-nav__link">
        Á¥¢Âºï
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
      
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          Âè•Ê≥ïÂ≠¶Syntax
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Âè•Ê≥ïÂ≠¶Syntax
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Ling/Syntax/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Ling/Syntax/conv_gen/" class="md-nav__link">
        ËΩ¨Êç¢ÁîüÊàêÂè•Ê≥ï
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Ling/Syntax/uni_gram/" class="md-nav__link">
        ÊôÆÈÅçËØ≠Ê≥ï
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Ling/Syntax/ud_sud/" class="md-nav__link">
        ‰æùÂ≠òÂè•Ê≥ïUD&SUD
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
      
      
      
        <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
          ËØ≠‰πâÂ≠¶Semantics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          ËØ≠‰πâÂ≠¶Semantics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Ling/Semantics/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Ling/Semantics/definitions/" class="md-nav__link">
        Definition Clearification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Ling/Semantics/formal_semantics/" class="md-nav__link">
        Logics & Formal Semantics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Ling/Semantics/ambiguity/" class="md-nav__link">
        Scope Ambiguity
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
          ËØ≠Áî®Â≠¶Pragmatics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          ËØ≠Áî®Â≠¶Pragmatics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Ling/Pragmatics/intro/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Ling/Pragmatics/theories/" class="md-nav__link">
        Theory&Hypothesis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Ling/Pragmatics/socio/" class="md-nav__link">
        Sociopragmatics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Ling/Pragmatics/ca_da/" class="md-nav__link">
        Research Methods
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Ling/pol_zh/" class="md-nav__link">
        ËØ≠Ë®ÄÂì≤Â≠¶Philosophy of Language
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          üí≠ËØ¥ÁûéËØù‰∫Ü
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          üí≠ËØ¥ÁûéËØù‰∫Ü
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Other/" class="md-nav__link">
        Á¥¢Âºï
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Other/tools/" class="md-nav__link">
        ÊàëÁöÑÂ∑•ÂÖ∑ÁÆ±ÔºÅ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Other/apa/" class="md-nav__link">
        APA Format
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Other/nlp_resources/" class="md-nav__link">
        DL & NLP ËµÑÊ∫êÊï¥ÁêÜ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Other/portfolio/" class="md-nav__link">
        Portfolio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Other/24fall/" class="md-nav__link">
        24fallÁî≥ËØ∑ËÆ∞ÂΩï
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Other/zju_ling_cs/" class="md-nav__link">
        Ëã±‰∏ìËΩ¨CS&NLPÊåáÂåó
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Other/nlp_phd/" class="md-nav__link">
        NLPÁî≥ËØ∑PhDÁªèÈ™å(Êê¨Ëøê)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="ÁõÆÂΩï">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ÁõÆÂΩï
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    ËÉåÊôØÁü•ËØÜ
  </a>
  
    <nav class="md-nav" aria-label="ËÉåÊôØÁü•ËØÜ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    ÁâπÊùÉÊ®°Âºè
  </a>
  
    <nav class="md-nav" aria-label="ÁâπÊùÉÊ®°Âºè">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#os" class="md-nav__link">
    ËÆ°ÁÆóÊú∫‰∏äÁîµÂà∞OSËøêË°åÁöÑËøáÁ®ã
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sbiopensbi" class="md-nav__link">
    sbiÂíåopensbi
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    ÁéØÂ¢ÉÈÖçÁΩÆ
  </a>
  
    <nav class="md-nav" aria-label="ÁéØÂ¢ÉÈÖçÁΩÆ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    Docker
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker_1" class="md-nav__link">
    ËÅ™ÊòéÂú∞‰ΩøÁî®docker
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    ÊñπÊ≥ï‰ªãÁªç
  </a>
  
    <nav class="md-nav" aria-label="ÊñπÊ≥ï‰ªãÁªç">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qemu-gdb" class="md-nav__link">
    qemu + gdb Ë∞ÉËØï
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gdb" class="md-nav__link">
    ËÅ™ÊòéÂú∞‰ΩøÁî® gdb
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab0" class="md-nav__link">
    lab0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab1" class="md-nav__link">
    lab1
  </a>
  
    <nav class="md-nav" aria-label="lab1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#c-risc-v" class="md-nav__link">
    C &amp; RISC-V ÂÜÖËÅîÊ±áÁºñ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    ÁºñËØëÁöÑÁü•ËØÜ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#risc-v" class="md-nav__link">
    RISC-V Êó∂Èíü‰∏≠Êñ≠
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#riscv" class="md-nav__link">
    RISCV ÂØÑÂ≠òÂô®
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sv39" class="md-nav__link">
    Sv39 ÁöÑÈ°µË°®È°π
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    Âú∞ÂùÄÁøªËØëËøáÁ®ã
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heads-todo-va2pa_offset" class="md-nav__link">
    ‰∏∫‰ªÄ‰πàÂú® head.S Èáå‰∏ÄÂºÄÂßãË¶ÅÁªôÈ°µË°®È°πÂú∞ÂùÄ (TODOÂùè‰∫Ü‰∏çËÆ∞ÂæóÊòØ‰∏çÊòØÂÆÉ‰∫Ü) ÂáèÂéª‰∏Ä‰∏™ VA2PA_offset
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab4" class="md-nav__link">
    lab4
  </a>
  
    <nav class="md-nav" aria-label="lab4">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    Êõ¥Êñ∞ÂêéÁöÑËôöÊãüÂÜÖÂ≠òÂ∏ÉÂ±Ä
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab5" class="md-nav__link">
    lab5
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab6" class="md-nav__link">
    lab6
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab7" class="md-nav__link">
    lab7
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    Â∏∏ËßÅÈóÆÈ¢ò‰πãË°•ÂÖÖÂèàÂêçÊàë‰πãÊÄªÊòØÈÅáËßÅÈóÆÈ¢ò
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="os-lab">OS lab</h1>
<p>ÁõÆÂΩïÔºöËøôÈáå‰ºöÂÖàËÆ≤‰∏Ä‰∏ãÁî®Âà∞ÁöÑËÉåÊôØÁü•ËØÜÂíå mac ‰∏ãÁöÑÁéØÂ¢ÉÈÖçÁΩÆÊäÄÂ∑ßÔºàÂõ†‰∏∫ÊâãÂÜåËÆ≤ mac ‰∏çÂ§öÔºâÔºåÁÑ∂ÂêéÊå®‰∏™ÂÆûÈ™åÊàëÊÉ≥ËøõË°å‰∏Ä‰∫õÁªºËø∞Ôºå‰∏çÁü•ÈÅìÁ≤æÂäõËÉΩÊîØÊíëÂÜôÂ§öÂ∞ëÔºåÊúÄÂêéË°•ÂÖÖ‰∏§‰∏™ÊàëÂÆûÈ™å‰∏≠ÊÄªÈÅáÂà∞ÁöÑ‰ΩÜÊâãÂÜåÊ≤°Ê∂âÂèäÁöÑÈóÆÈ¢ò„ÄÇËá™Áü•Â≠¶Âæó‰∏çÂ•ΩÔºå‰∏çÁ°ÆÂÆöÁöÑÂú∞ÊñπÊàë‰ºöÊ†áÂá∫Êù•„ÄÇ</p>
<h2 id="overview">overview</h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>TODO</p>
</div>
<p>‰∏Ä‰∏™ÊúÄÂêéÂÅöÂá∫Êù•ÁöÑ lab ÁªìÊûÑÂõæ:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>
</span></code></pre></div>
<h2 id="_1">ËÉåÊôØÁü•ËØÜ</h2>
<h3 id="_2">ÁâπÊùÉÊ®°Âºè</h3>
<p>riscvÊúâ‰∏âÁßçÁâπÊùÉÊ®°ÂºèÔºöUser Supervisor Machine</p>
<table>
<thead>
<tr>
<th>Level</th>
<th>Encoding</th>
<th>Name</th>
<th>Abbreviation</th>
<th>‰ªãÁªç</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>00</td>
<td>User/Application</td>
<td>U</td>
<td>ÂØπÁ°¨‰ª∂Ê®°ÂºèÁöÑÊäΩË±°ÔºåÊúâÊúÄÈ´òÁ∫ßÂà´ÁöÑÊùÉÈôê</td>
</tr>
<tr>
<td>1</td>
<td>01</td>
<td>Supervisor</td>
<td>S</td>
<td>ÂØπÂ∫î‰∏éÂÜÖÊ†∏ÊÄÅKernel„ÄÇÂΩìÁî®Êà∑ÈúÄË¶ÅÂÜÖÊ†∏ËµÑÊ∫êÊó∂ÔºåÂêëÂÜÖÊ†∏Áî≥ËØ∑ÔºåÂπ∂ÂàáÊç¢Âà∞ÂÜÖÊ†∏ÊÄÅËøõË°åÂ§ÑÁêÜ</td>
</tr>
<tr>
<td>2</td>
<td>10</td>
<td>Reserved</td>
<td></td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>11</td>
<td>Machine</td>
<td>M</td>
<td>Áî®Êà∑ÊÄÅÔºåÊúÄ‰ΩéÁ∫ßÂà´ÊùÉÈôê</td>
</tr>
</tbody>
</table>
<p>‰∏ÄËà¨ÂèØ‰ª•ËøêË°åÁöÑÁ®ãÂ∫èÊúâ</p>
<table>
<thead>
<tr>
<th>supported modes</th>
<th>intended usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>M</td>
<td>simple embedded systems</td>
</tr>
<tr>
<td>M, U</td>
<td>secure embedded systems</td>
</tr>
<tr>
<td>M, S, U</td>
<td>systems running unix-like operating systems</td>
</tr>
</tbody>
</table>
<h4 id="os">ËÆ°ÁÆóÊú∫‰∏äÁîµÂà∞OSËøêË°åÁöÑËøáÁ®ã</h4>
<p>ÂµåÂÖ•ÂºèÁ≥ªÁªüÔºàÁõ∏ÊØîËÆ°ÁÆóÊú∫Á≥ªÁªüÊØîËæÉÁÆÄÂçïÔºåÂè™ËÉΩÂú®ÁâπÂÆöÁ°¨‰ª∂‰∏äËøêË°åÔºâÁöÑÂêØÂä®ËøáÁ®ãÊØîËæÉÁÆÄÂçïÔºåÁî®ÂÆÉÊù•ÂÅö‰æãÂ≠êËÆ≤Ëß£Ôºö</p>
<ul>
<li>‰∏äÁîµÔºåÂØπÁ°¨‰ª∂ËøõË°å‰∏Ä‰∫õÁÆÄÂçïÁöÑÂàùÂßãÂåñ</li>
<li>Â∞ÜCPUÁöÑprogram counterÁßªÂä®Âà∞ÂÜÖÂ≠òÁöÑbootloaderÁöÑËµ∑ÂßãÂú∞ÂùÄ„ÄÇbootloaderÁî®‰∫éÊìç‰ΩúÁ≥ªÁªüËøêË°åÂÜÖÊ†∏‰πãÂâçÔºåÂàùÂßãÂåñÁ°¨‰ª∂ÔºåÂä†ËΩΩÊìç‰ΩúÁ≥ªÁªüÂÜÖÊ†∏„ÄÇ</li>
<li>riscvÊû∂ÊûÑ‰∏ãbootloaderËøêË°åÂú®MÊ®°Âºè‰∏ãÔºåbootloaderËøêË°åÂÆåÊØïÂêéÂàáÊç¢Âà∞SÊ®°ÂºèÔºåÈöèÂêéÂºÄÂßãËøêË°åkernel„ÄÇ</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>Hardware             RISC-V M Mode           RISC-V S Mode 
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>+------------+         +--------------+         +----------+
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>|  Power On  |  ----&gt;  |  Bootloader  |  ----&gt;  |  Kernel  |
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>+------------+         +--------------+         +----------+
</span></code></pre></div>
<h3 id="sbiopensbi">sbiÂíåopensbi</h3>
<p>sbi (supervisor binary interface)ÊòØs-modeÁöÑkernelÂíåm-modeÊâßË°åÁéØÂ¢É‰πãÈó¥ÁöÑÊé•Âè£ËßÑËåÉ</p>
<p>opensbiÊòØ‰∏Ä‰∏™riscv sbiËßÑËåÉÁöÑÂºÄÊ∫êÂÆûÁé∞ÔºåÊÄª‰πãÊÑèÊÄùÊòØopensbiÊòØ‰∏Ä‰∫õÂØπm-mode‰∏ãÁ°¨‰ª∂ÁöÑÁªü‰∏ÄÂÆö‰πâÔºåÂú®s-mode‰∏ãÁöÑÂÜÖÊ†∏ÂèØ‰ª•ÊåâÁÖßËøô‰∫õËßÑËåÉÂØπ‰∏çÂêåÁ°¨‰ª∂Êìç‰Ωú„ÄÇ</p>
<p>Êàë‰ª¨opensbiÂèØ‰ª•‰Ωú‰∏∫bootloaderÂÆåÊàêÊú∫Âô®ÂêØÂä®Êó∂m-mode‰∏ãÁöÑÁ°¨‰ª∂ÂàùÂßãÂåñÂíåÂØÑÂ≠òÂô®ËÆæÁΩÆÔºåÂèØ‰ª•Âà©Áî®opensbiÂÆåÊàêÂ≠óÁ¨¶ÊâìÂç∞‰πãÁ±ªÁöÑÊìç‰Ωú„ÄÇ</p>
<p><img alt="opensbi" src="../../asset/opensbi.png" /></p>
<p>qemu‰ºöÊääopensbiËµ∑ÂßãÂú∞ÂùÄÂä†ËΩΩÂà∞0x80000000Â§Ñ.</p>
<p>opensbiÂàùÂßãÂåñÂêé‰ºöË∑≥ËΩ¨Âà∞0x80200000Â§ÑÔºåÂç≥kernelÁöÑËµ∑ÂßãÂú∞ÂùÄ„ÄÇÊâÄ‰ª•Ë¶ÅÁºñËØëÁöÑ‰ª£Á†ÅÂú®0x80200000Â§Ñ„ÄÇ</p>
<h2 id="_3">ÁéØÂ¢ÉÈÖçÁΩÆ</h2>
<h3 id="docker">Docker</h3>
<p>Âú®ÂÆòÁΩëÂÆâË£ÖDocker„ÄÇ‰πãÂêéÈúÄË¶ÅÊâìÂºÄDocker appÔºåÁôªÈôÜÂêéÊâçËÉΩÂú®terminal‰∏≠‰ΩøÁî®dockerÂëΩ‰ª§„ÄÇ</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>$<span class="w"> </span>sudo<span class="w"> </span>hdiutil<span class="w"> </span>attach<span class="w"> </span>Docker.dmg
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>$<span class="w"> </span>sudo<span class="w"> </span>/Volumes/Docker/Docker.app/Contents/MacOS/install
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>$<span class="w"> </span>sudo<span class="w"> </span>hdiutil<span class="w"> </span>detach<span class="w"> </span>/Volumes/Docker
</span></code></pre></div>
<p>ÂàõÂª∫ÂÆπÂô®</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>docker<span class="w"> </span>pull<span class="w"> </span>ubuntu:22.04
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--name<span class="w"> </span>my_linux<span class="w"> </span>ubuntu:22.04<span class="w"> </span>bash
</span></code></pre></div>
<p>Âá∫Áé∞root@xxxxxxx:?# Âç≥ÂàõÂª∫ÊàêÂäüÔºåÂÖ∂‰∏≠xxxxxxx‰∏Ä‰∏≤ÊòØÂΩìÂâçÂÆπÂô®ÁöÑidÔºåÈúÄË¶ÅËÆ∞ÂΩï‰∏ãÊù•Ôºå‰∏ãÊ¨°ÂèØ‰ª•ÈÄöËøáËØ•idËøõÂÖ•Áõ∏ÂêåÂÆπÂô®„ÄÇ</p>
<p><img alt="terminal" src="../../asset/terminal.png" /></p>
<p>ÂÆâË£Ö‰∫§ÂèâÁºñËØëÂ∑•ÂÖ∑ÂåÖÔºåqemuÔºågdbÔºåËøôÂá†Ê≠•ÈúÄË¶ÅÂºÄÁùÄÂëΩ‰ª§Ë°å‰ª£ÁêÜÔºåÊà™ÂõæÁï•„ÄÇ</p>
<h3 id="docker_1">ËÅ™ÊòéÂú∞‰ΩøÁî®docker</h3>
<p>ËøòÊòØÊúÄÂ•ΩÈÖçÁΩÆ‰∏Ä‰∏ã vscode ÈáåÁöÑÂõæÂΩ¢ÁïåÈù¢„ÄÇÊ≠•È™§Ôºö</p>
<ul>
<li>È¶ñÂÖàÂú® vscode ÈáåÂÆâË£Ö docker Êèí‰ª∂„ÄÇ</li>
<li>‰ª•‰ªÄ‰πàÊñπÂºèÂÖ≥ËÅî‰∏ä docker ÂøòËÆ∞‰∫ÜÔºåÂèØËÉΩÊòØËæìÂÖ•Ë¥¶Âè∑ÂØÜÁ†ÅÁôªÈôÜ„ÄÇÁÑ∂ÂêéÂú® docker Êèí‰ª∂ÈáåÂ∞±ÂèØ‰ª•ÁúãÂà∞‰Ω†ÁöÑÊâÄÊúâÂÆπÂô®„ÄÇ</li>
<li>Êñá‰ª∂ÁÆ°ÁêÜ‰∏äÔºö‰∏™‰∫∫ËÆ§‰∏∫ÊØè‰∏™ lab ÁöÑÊñá‰ª∂Â§πÂú® docker ‰∏äÂçïÁã¨ÂºÄ‰∏Ä‰∏™Êñá‰ª∂Â§πÊØîËæÉÂ•Ω‰Ωø„ÄÇÂÆπÂô®ÈáåÁïôÊúÄÊñ∞Áâà‰ª£Á†ÅÔºåÊú¨Âú∞ÁïôÊã∑Ë¥ù„ÄÇ</li>
<li>gui ‰ΩøÁî®‰∏äÔºöÊúâ‰∏âÁßçÁºñËæëÊñá‰ª∂ÂíåËøêË°åÁöÑÊñπÊ≥ï„ÄÇ(1) ÊääÂÆπÂô® attech new windowÔºåÂú®ÂçïÁã¨Á™óÂè£‰πüÂç≥ÂÆπÂô®ÈáåÁºñËæë‰ª£Á†ÅÂíåËøêË°åÁªàÁ´Ø„ÄÇ(2) Âú®Êú¨Âú∞‰øÆÊîπ‰ª£Á†ÅÔºåÊØèÊ¨°ËøêË°åÁöÑÊó∂ÂÄô cp Âà∞ dockerÔºåÂÜçÊääÂÆπÂô® attach shell ËøêË°å„ÄÇ(3) Áõ¥Êé•Áî® docker Êèí‰ª∂ÂéªËÆøÈóÆÊñá‰ª∂ÁõÆÂΩïÔºåÁÑ∂Âêé attach shell ÂéªËøêË°å„ÄÇÂêé‰∏§ËÄÖÈÉΩÊûÅÂÖ∂ÈöæÁî®„ÄÇÊàë‰∏çÊÉ≥Ëß£ÈáäÈöæÁî®Âú®Âì™Èáå‰∫ÜÔºåËôΩÁÑ∂‰πü‰ΩøÊàëÁÜüÁªÉÊéåÊè°‰∫ÜÁî®ÂëΩ‰ª§Ë°åÊéßÂà∂ËøõÂÖ•Êñ∞ÁöÑÂÆπÂô®ÂíåËøõÂÖ•Â∑≤ÊúâÁöÑÂÆπÂô®Âíå <code>ps a</code> Âíå <code>kill qemu</code> Á≠âÂëΩ‰ª§„ÄÇ„ÄÇÂΩìÁÑ∂ÂèØËÉΩ‰πüÂè™ÊúâÁ¨®ËõãÊàëÊåâÁÖßÂêé‰∏§ÁßçÁî®‰∫ÜÂ•Ω‰πÖ„ÄÇ</li>
</ul>
<h2 id="_4">ÊñπÊ≥ï‰ªãÁªç</h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>TODO</p>
</div>
<ul>
<li>shellËÑöÊú¨ÔºöÁõ∏ÂΩì‰∫é‰∏ÄÁªÑÊâìÂåÖÂ•ΩÁöÑÂëΩ‰ª§Ë°åÔºåÈáåÈù¢ÂëΩ‰ª§Áî®Êù•ÊåáÁ§∫ÂëΩ‰ª§Ë°åÁöÑËøêË°åÈ°∫Â∫èÁ≠â„ÄÇÂèØ‰ª•Áõ¥Êé•Áî® <code>bash [shell file].sh</code> Êù•ËøêË°å„ÄÇ</li>
<li>qemuÔºö‰∏Ä‰∏™ÂèØ‰ª•Âú®x86Âπ≥Âè∞‰∏äÊâßË°å‰∏çÂêåÊû∂ÊûÑ‰∏ãÁ®ãÂ∫èÁöÑÊ®°ÊãüÂô®ÔºåÊú¨ÂÆûÈ™å‰∏≠Áî®qemuÂÆåÊàêÂØπriscvÊû∂ÊûÑÁ®ãÂ∫èÁöÑÊ®°Êãü„ÄÇ</li>
<li>gdbÔºöÊòØgnu debuggerÁöÑÁº©ÂÜôÔºåÊòØ‰∏Ä‰∏™unix/linuxÁ≥ªÁªü‰∏ãÁöÑÂü∫‰∫éÂëΩ‰ª§Ë°åÁöÑË∞ÉËØïÂ∑•ÂÖ∑„ÄÇËÉΩÂ§üÂêØÂä®„ÄÅÊåáÂÆöÊù°‰ª∂ÂÅúÊ≠¢„ÄÅÊ£ÄÊü•„ÄÅÊõ¥ÊîπÁ®ãÂ∫è„ÄÇ</li>
<li>‰∫§ÂèâÁºñËØëÔºöÁî®‰∏Ä‰∏™Êû∂ÊûÑÁöÑÂπ≥Âè∞ÁºñËØëÂè¶‰∏Ä‰∏™Êû∂ÊûÑËøêË°åÁöÑÁ®ãÂ∫èÔºåÂ¶ÇÁî®x86ÁºñËØëriscvËøêË°åÁöÑÁ®ãÂ∫è„ÄÇÊàë‰ª¨Áî®ÁöÑ‰∫§ÂèâÁºñËØëÈìæÊòØ <code>riscv-gnu-toolchain</code> „ÄÇ</li>
<li>ÂÜÖÊ†∏ÈÖçÁΩÆÔºöÂÜÖÊ†∏ÈÖçÁΩÆÊòØÁî®‰∫éÈÖçÂà∂ÊòØÂê¶ÂêØÁî®ÂÜÖÊ†∏ÁöÑÂêÑÈ°πÁâπÊÄßÔºåÂÜôÂú®Êñá‰ª∂defconfigÈáå„ÄÇ</li>
<li>ÁºñËØëÂ∑•ÂÖ∑ÔºömakefileÔºåmakefileÁü•ËØÜÊàëÊ≤°Â≠¶Â•ΩÔºå‰∏çËøáÁé∞Âú®gptÂÜôÂæóÊØîÊàëÂ•Ω„ÄÇ</li>
</ul>
<h3 id="qemu-gdb">qemu + gdb Ë∞ÉËØï</h3>
<p>ÈúÄË¶ÅË∞ÉËØïÊó∂ÔºåÂõ†‰∏∫È°∂Â±Ç makefile Â∏ÆÊàë‰ª¨ÂÜôÂ•Ω‰∫ÜË∞ÉËØïÂëΩ‰ª§ÔºåÊàë‰ª¨Á¨¨‰∏Ä‰∏™ terminal Âè™ÈúÄË¶ÅËæìÂÖ• <code>make debug</code>„ÄÇ
ÁÑ∂ÂêéÊñ∞ÂºÄ‰∏Ä‰∏™ terminal ËæìÂÖ• <code>gdb-multiarch path/to/vmlinux</code> ÂÖ∂‰∏≠ vmlinux ÊòØÁºñËØëÂ•ΩÁöÑÊñá‰ª∂„ÄÇ</p>
<p>gdb ‰ΩøÁî®ÁöÑÊñπÊ≥ï/Á™çÈó®</p>
<ul>
<li>È¶ñÂÖàÊåâÂõûËΩ¶ÂèØ‰ª•Ëá™Âä®ÊâßË°å‰∏ä‰∏ÄÊù°ËØ≠Âè•Ôºå‰∏çÁî®ÈáçÊñ∞ÊâãÊâì‰∏ÄÈÅç„ÄÇ</li>
<li>Ê≠§Â§ñÊï¥‰∏™ÂÆûÈ™åÈúÄË¶ÅÁî®Âà∞ÁöÑÂëΩ‰ª§ËßÅ‰∏ãÊñπË°®Ê†º</li>
</ul>
<table>
<thead>
<tr>
<th>ÊòæÁ§∫ÊúâÂÖ≥ÁöÑ</th>
<th>ÁÆÄÂÜô</th>
<th>Êåá‰ª§</th>
</tr>
</thead>
<tbody>
<tr>
<td>ÊòæÁ§∫Ê∫ê‰ª£Á†Å</td>
<td></td>
<td>layout src</td>
</tr>
<tr>
<td>ÊòæÁ§∫Ê±áÁºñ‰ª£Á†Å</td>
<td></td>
<td>layout asm</td>
</tr>
<tr>
<td>ÈÄÄÂá∫Ê±áÁºñÊòæÁ§∫</td>
<td></td>
<td>ctrl+x, A</td>
</tr>
<tr>
<td>ÈÄÄÂá∫gdb</td>
<td></td>
<td>quit</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ÊâßË°åÊúâÂÖ≥ÁöÑ</td>
<td>ÁÆÄÂÜô</td>
<td>Êåá‰ª§</td>
</tr>
<tr>
<td>ÂçïÊ≠•ÊâßË°åÔºåËøêË°åÁ®ãÂ∫èÔºåÂÅúÂú®Á¨¨‰∏ÄÊâßË°åËØ≠Âè•</td>
<td></td>
<td>start</td>
</tr>
<tr>
<td>Êñ≠ÁÇπÂêéÁªßÁª≠ÊâßË°å</td>
<td>c</td>
<td>continue</td>
</tr>
<tr>
<td>ÂçïÊ≠•Ë∞ÉËØïÔºàÈÄêcËØ≠Ë®ÄËØ≠Âè•ÔºåÂáΩÊï∞Áõ¥Êé•ÊâßË°åÔºâ</td>
<td>n</td>
<td>next</td>
</tr>
<tr>
<td>ÊâßË°åÂçïÊù°Êåá‰ª§</td>
<td>si</td>
<td>step instruction</td>
</tr>
<tr>
<td>ÈáçÊñ∞ÂºÄÂßãËøêË°åÊñá‰ª∂Ôºàrun-textÔºöÂä†ËΩΩÊñáÊú¨Êñá‰ª∂Ôºårun-binÔºöÂä†ËΩΩ‰∫åËøõÂà∂Êñá‰ª∂Ôºâ</td>
<td>r</td>
<td>run</td>
</tr>
<tr>
<td>ÁªìÊùüÂΩìÂâçÂáΩÊï∞ÔºåËøîÂõûÂà∞ÂáΩÊï∞Ë∞ÉÁî®ÁÇπ</td>
<td></td>
<td>finish</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Êñ≠ÁÇπÊúâÂÖ≥</td>
<td>ÁÆÄÂÜô</td>
<td>Êåá‰ª§</td>
</tr>
<tr>
<td>ËÆæÁΩÆÊñ≠ÁÇπÂú®fooÂáΩÊï∞</td>
<td>b foo</td>
<td>break foo</td>
</tr>
<tr>
<td>Êñ≠Âú®ÊüêÂú∞ÂùÄ</td>
<td>b * 0x80200000</td>
<td>break * 0x80200000</td>
</tr>
<tr>
<td>Êü•ÁúãÁ¨¨m‰∏™-Á¨¨n‰∏™Êñ≠ÁÇπ</td>
<td></td>
<td>info breakpoints [LIST]</td>
</tr>
<tr>
<td>Êü•ÁúãÊâÄÊúâÊñ≠ÁÇπ</td>
<td></td>
<td>info breakpoints</td>
</tr>
<tr>
<td>Âà†Èô§NÂè∑Êñ≠ÁÇπ</td>
<td></td>
<td>delete [N]</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Â±ïÁ§∫ÂÄºÊúâÂÖ≥ÁöÑ</td>
<td>ÁÆÄÂÜô</td>
<td>Êåá‰ª§</td>
</tr>
<tr>
<td>Êü•ÁúãÂáΩÊï∞ÁöÑË∞ÉÁî®ÁöÑÊ†àÂ∏ßÂíåÂ±ÇÁ∫ßÂÖ≥Á≥ª</td>
<td>bt</td>
<td>backtrace</td>
</tr>
<tr>
<td>ÂàáÊç¢ÂáΩÊï∞ÁöÑÊ†àÂ∏ß</td>
<td>f</td>
<td>frame</td>
</tr>
<tr>
<td>ÊâìÂç∞ÂÄºÂèäÂú∞ÂùÄ</td>
<td>p</td>
<td>print</td>
</tr>
<tr>
<td>Êü•ÁúãÂáΩÊï∞ÂÜÖÈÉ®Â±ÄÈÉ®ÂèòÈáèÁöÑÊï∞ÂÄº</td>
<td>i</td>
<td>ifo</td>
</tr>
<tr>
<td>Êü•ÁúãÂØÑÂ≠òÂô® ra ÁöÑÂÄº</td>
<td>i r ra</td>
<td></td>
</tr>
<tr>
<td>ËøΩË∏™Êü•ÁúãÂÖ∑‰ΩìÂèòÈáèÂÄº</td>
<td></td>
<td>display []</td>
</tr>
<tr>
<td>‰ª• 16 ËøõÂà∂ÊâìÂç∞¬†<addr>¬†Â§ÑÂºÄÂßãÁöÑ 16 Bytes ÂÜÖÂÆπ</td>
<td></td>
<td>x/4x <addr></td>
</tr>
<tr>
<td>ÊòæÁ§∫Êï∞ÁªÑ</td>
<td></td>
<td>p *swapper_pg_dir@100</td>
</tr>
<tr>
<td>16ËøõÂà∂ÊòæÁ§∫ÔºàxÂÄçÊï∞Âè™ËÉΩ‰∏∫1Ôºâ</td>
<td></td>
<td>p/x swapper_pg_dir [start]@1</td>
</tr>
</tbody>
</table>
<div class="admonition question">
<p class="admonition-title">Ë∞ÉËØïÁöÑÊó∂ÂÄôÈúÄË¶ÅÁúã‰ªÄ‰πàÂë¢Ôºü</p>
<p>ËøôÊòØÊàëÂàö‰∏äÊâãË∞ÉËØïÁöÑÊó∂ÂÄôÊÑüÂà∞Âõ∞Êâ∞ÁöÑ‰∏Ä‰∏™ÈóÆÈ¢ò„ÄÇ</p>
<p>ÂêéÊù•ÊàëÈÄêÊ∏êÊÉ≥Ê∏ÖÊ•öÁöÑÊòØÔºåÈ¶ñÂÖàÊàëËÆ§‰∏∫Â¶ÇÊûú‰∏çÁü•ÈÅìÊ≠£Âú®ËøêË°åÁöÑÁ®ãÂ∫èËøêË°åÁöÑÊµÅÁ®ãÔºàÊØîÂ¶ÇÂÖàÂì™‰∏™ÂáΩÊï∞ÂÜçÂì™‰∏™ÂáΩÊï∞ÔºâÔºåÊòØ‰∏çÈÄÇÂêàÂºÄÂßãË∞ÉËØïÁöÑÔºåÂ∫îÂΩìÂõûÂéªÂÜçÊÄùËÄÉ‰∏ÄÈÅç lab ÁöÑÁêÜËÆ∫ÔºåËµ∑Á†ÅÁü•ÈÅìËá™Â∑±Á®ãÂ∫èÁöÑÂêÑÁßçÈ¢ÑÊúüÁªìÊûú„ÄÇÊö¥ËÆ∫‰∏ÄÁÇπËØ¥ÂÖ∂ÂÆûÊàëËßâÂæóË∞ÉËØïÊó∂ÈïøÂ§ß‰∫éÂºÄÂèëÊó∂ÈïøÈÉΩÊòØ‰∏çÂ§™Â•ΩÁöÑÔºåÊö¥Èú≤Âá∫ËÇØÂÆöÂì™ÈáåÁêÜËÆ∫Ê≤°ÂïÉÈÄèÂ∞±ÂºÄÂßãÂä®Á¨î‰∫Ü„ÄÇ</p>
<p>ÁÑ∂ÂêéÂèØ‰ª•Áî±Â§ßÂà∞Â∞èÔºåÊØîÂ¶ÇÂÖàÊääÂá†‰∏™Êñ≠ÁÇπÊâìÂú®ÁåúÊµãÂèØËÉΩÂá∫Èîô‰∫ÜÁöÑÂá†‰∏™ÂáΩÊï∞‰∏äÔºåÁ°ÆÂÆöÂÖ∑‰ΩìÂú®Âì™‰∏™ÂáΩÊï∞Âá∫ÈîôÂêéÂÜçÈÄê c ËØ≠Ë®ÄË°åËøêË°åÔºåÁ°ÆÂÆöÊòØÂì™‰∏™ c ËØ≠Ë®ÄË°åÂá∫ÈîôÂêéÂÜçÈÄêÊ±áÁºñË°åËøêË°åÔºåÂæ™Â∫èÊ∏êËøõÊâæÂà∞ÂÖ∑‰ΩìÂá∫ÈîôÁöÑÊåá‰ª§„ÄÇÂú®ÈôÑËøëÊâìÂç∞ÊâìÂç∞Âá†‰∏™ÂØÑÂ≠òÂô®ÁöÑÂÄºÔºàÂèØ‰ª•ÁúãÁöÑÂØÑÂ≠òÂô®Êàë‰ºöÂú®‰∏ã‰∏ÄËäÇ‰ªãÁªçÔºâÔºåÁÑ∂ÂêéÂú®Ê≠§Âü∫Á°Ä‰∏äÊÄùËÄÉÈîôËØØÂéüÂõ†„ÄÇ</p>
</div>
<h3 id="gdb">ËÅ™ÊòéÂú∞‰ΩøÁî® gdb</h3>
<p>gdb Ëá™Â∏¶ÁöÑÂëΩ‰ª§Ë°å ui Áº∫ÁÇπ‰∏ªË¶ÅÂú®‰∫é‰∏çËÉΩÈöèÊó∂ÊòæÁ§∫ÂØÑÂ≠òÂô®ÂíåÂèòÈáèÁöÑÂÄºÔºåË∞ÉËØï‰ºö‰∏çËàíÊúç„ÄÇÊúâ‰∏Ä‰∫õÊõ¥Â•ΩÁöÑ ui Â∑•ÂÖ∑„ÄÇ</p>
<p>ÊàëÊ≤°ÊúâÈÖçÊâÄ‰ª•‰∏çËÉΩÊèê‰æõÂæàÂ•ΩÁöÑÊàëÁöÑÊé®ËçêÔºåË¥¥‰∏Ä‰∫õÂà´‰∫∫ÁöÑÂ∏ñÂ≠ê„ÄÇÈô§‰∫Ü‰∏ãÈù¢Â∏ñÂ≠êÈáåÊèêÂà∞ÁöÑÂá†‰∏™ÔºåËê±Ëê±ËøòÊèêÂà∞‰∏Ä‰∏™ <code>gdbpeda</code>„ÄÇ</p>
<p><a href="https://www.cnblogs.com/liuhanxu/p/17011775.html">Êé®ËçêÂá†‰∏™Â•ΩÁî®ÁöÑGDBÂõæÂΩ¢ÂåñÂäüËÉΩÂ¢ûÂº∫Êèí‰ª∂</a></p>
<h2 id="lab0">lab0</h2>
<p>Ê≤°ÈöæÂ∫¶‰∏çÁî®ËÆ≤</p>
<h2 id="lab1">lab1</h2>
<h3 id="c-risc-v">C &amp; RISC-V ÂÜÖËÅîÊ±áÁºñ</h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ËøôÂùóÊù•Ëá™‰∫éÂØπ lab1 ÊñáÊ°£ÁöÑÊï¥ÁêÜ„ÄÇÂ∏åÊúõÊúâÊï¥ÁêÜÂæóÊØîÂéüÊñáÊ°£ÂèØËØª‰∏Ä‰∫õ„ÄÇ</p>
</div>
<div class="language-c highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">__asm__</span><span class="w"> </span><span class="k">volatile</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">        </span><span class="s">&quot;instruction1</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">        </span><span class="s">&quot;instruction2</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">        </span><span class="p">......</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">        </span><span class="p">......</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">        </span><span class="s">&quot;instruction3</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">out1</span><span class="p">]</span><span class="w"> </span><span class="s">&quot;=r&quot;</span><span class="w"> </span><span class="p">(</span><span class="n">v1</span><span class="p">),[</span><span class="n">out2</span><span class="p">]</span><span class="w"> </span><span class="s">&quot;=r&quot;</span><span class="w"> </span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">in1</span><span class="p">]</span><span class="w"> </span><span class="s">&quot;r&quot;</span><span class="w"> </span><span class="p">(</span><span class="n">v1</span><span class="p">),</span><span class="w"> </span><span class="p">[</span><span class="n">in2</span><span class="p">]</span><span class="w"> </span><span class="s">&quot;r&quot;</span><span class="w"> </span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;memory&quot;</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">    </span><span class="p">);</span>
</span></code></pre></div>
<p>ÂÖ∂‰∏≠Ôºå‰∏â‰∏™¬†<code>:</code>¬†Â∞ÜÊ±áÁºñÈÉ®ÂàÜÂàÜÊàê‰∫ÜÂõõÈÉ®ÂàÜ„ÄÇËøôÂõõÈÉ®ÂàÜ‰∏≠Âêé‰∏âÈÉ®ÂàÜ‰∏çÊòØÂøÖÈ°ªÁöÑÔºö</p>
<ul>
<li>Á¨¨‰∏ÄÈÉ®ÂàÜÊòØÊ±áÁºñÊåá‰ª§ÔºåÊåá‰ª§Êú´Â∞æÈúÄË¶ÅÊ∑ªÂä† '\n'„ÄÇ</li>
<li>Á¨¨‰∫åÈÉ®ÂàÜÊòØËæìÂá∫Êìç‰ΩúÊï∞ÈÉ®ÂàÜ„ÄÇ</li>
<li>Á¨¨‰∏âÈÉ®ÂàÜÊòØËæìÂÖ•Êìç‰ΩúÊï∞ÈÉ®ÂàÜ„ÄÇ</li>
<li>Á¨¨ÂõõÈÉ®ÂàÜÊòØÂèØËÉΩÂΩ±ÂìçÁöÑÂØÑÂ≠òÂô®ÊàñÂ≠òÂÇ®Âô®ÔºåÁî®‰∫éÂëäÁü•ÁºñËØëÂô®ÂΩìÂâçÂÜÖËÅîÊ±áÁºñËØ≠Âè•ÂèØËÉΩ‰ºöÂØπÊüê‰∫õÂØÑÂ≠òÂô®ÊàñÂÜÖÂ≠òËøõË°å‰øÆÊîπÔºå‰ΩøÂæóÁºñËØëÂô®Âú®‰ºòÂåñÊó∂Â∞ÜÂÖ∂Âõ†Á¥†ËÄÉËôëËøõÂéª„ÄÇ</li>
</ul>
<p>ËøôÊÆµÊöÇÊó∂Áî®‰∏çÁùÄÊàë‰∏çÂÜô‰∫ÜÔºåË¥¥‰∏ÄÊÆµlab1‰∏≠ÁöÑÂéüÊñáÁªôÁöÑÁ§∫‰æã„ÄÇe.g. 1</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">s_example</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">arg0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">ret_val</span><span class="p">;</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="n">__asm__</span><span class="w"> </span><span class="k">volatile</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">        </span><span class="s">&quot;mv x10, %[type]</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">        </span><span class="s">&quot;mv x11, %[arg0]</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">        </span><span class="s">&quot;mv %[ret_val], x12&quot;</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">ret_val</span><span class="p">]</span><span class="w"> </span><span class="s">&quot;=r&quot;</span><span class="w"> </span><span class="p">(</span><span class="n">ret_val</span><span class="p">)</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">type</span><span class="p">]</span><span class="w"> </span><span class="s">&quot;r&quot;</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">),</span><span class="w"> </span><span class="p">[</span><span class="n">arg0</span><span class="p">]</span><span class="w"> </span><span class="s">&quot;r&quot;</span><span class="w"> </span><span class="p">(</span><span class="n">arg0</span><span class="p">)</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;memory&quot;</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ret_val</span><span class="p">;</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="p">}</span>
</span></code></pre></div>
<p>e.g. 1. ‰∏≠Êåá‰ª§ÈÉ®ÂàÜÔºå%[type]„ÄÅ%[arg0]‰ª•Âèä%[ret_val]‰ª£Ë°®ÁùÄÁâπÂÆöÁöÑÂØÑÂ≠òÂô®ÊàñÊòØÂÜÖÂ≠ò„ÄÇËæìÂÖ•ËæìÂá∫ÈÉ®ÂàÜ‰∏≠Ôºå<code>[type] "r" (type)</code>‰ª£Ë°®ÁùÄÂ∞Ü¬†<code>()</code>¬†‰∏≠ÁöÑÂèòÈáè¬†<code>type</code>¬†ÊîæÂÖ•ÂØÑÂ≠òÂô®‰∏≠Ôºà<code>"r"</code>¬†ÊåáÊîæÂÖ•ÂØÑÂ≠òÂô®ÔºåÂ¶ÇÊûúÊòØ¬†<code>"m"</code>¬†Âàô‰∏∫ÊîæÂÖ•ÂÜÖÂ≠òÔºâÔºåÂπ∂‰∏îÁªëÂÆöÂà∞¬†<code>[]</code>¬†‰∏≠ÂëΩÂêçÁöÑÁ¨¶Âè∑‰∏≠Âéª„ÄÇ<code>[ret_val] "=r" (ret_val)</code>¬†‰ª£Ë°®ÁùÄÂ∞ÜÊ±áÁºñÊåá‰ª§‰∏≠¬†<code>%[ret_val]</code>¬†ÁöÑÂÄºÊõ¥Êñ∞Âà∞ÂèòÈáè¬†<code>ret_val</code> ‰∏≠„ÄÇ</p>
<p>e.g. 2</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="cp">#define write_csr(reg, val) ({</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="n">__asm__</span><span class="w"> </span><span class="k">volatile</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;csrw &quot;</span><span class="w"> </span><span class="err">#</span><span class="n">reg</span><span class="w"> </span><span class="s">&quot;, %0&quot;</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">&quot;r&quot;</span><span class="p">(</span><span class="n">val</span><span class="p">));</span><span class="w"> </span><span class="p">})</span>
</span></code></pre></div>
<p>e.g. 2. ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÂÆèÔºåÂÖ∂‰∏≠¬†<code>%0</code>¬†‰ª£Ë°®ÁùÄËæìÂá∫ËæìÂÖ•ÈÉ®ÂàÜÁöÑÁ¨¨‰∏Ä‰∏™Á¨¶Âè∑ÔºåÂç≥¬†<code>val</code>„ÄÇ <code>#reg</code>¬†ÊòØcËØ≠Ë®ÄÁöÑ‰∏Ä‰∏™ÁâπÊÆäÂÆèÂÆö‰πâËØ≠Ê≥ïÔºåÁõ∏ÂΩì‰∫éÂ∞ÜregËøõË°åÂÆèÊõøÊç¢Âπ∂Áî®ÂèåÂºïÂè∑ÂåÖË£πËµ∑Êù•„ÄÇ‰æãÂ¶Ç¬†<code>write_csr(sstatus,val)</code>¬†ÁªèÂÆèÂ±ïÂºÄ‰ºöÂæóÂà∞Ôºö</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="p">({</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">    </span><span class="n">__asm__</span><span class="w"> </span><span class="k">volatile</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;csrw &quot;</span><span class="w"> </span><span class="s">&quot;sstatus&quot;</span><span class="w"> </span><span class="s">&quot;, %0&quot;</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">&quot;r&quot;</span><span class="p">(</span><span class="n">val</span><span class="p">));</span><span class="w"> </span><span class="p">})</span>
</span></code></pre></div>
<p>Ê≠§Â§ñÔºåËøô‰∏™Á§∫‰æã‰∏≠ÁöÑ¬†<code>({...})</code>¬†ËøòÊ∂âÂèä‰∫Ü‰∏Ä‰∏™ GNU ÂØπ C ÁöÑÊâ©Â±ïÔºåÂèØ‰ª•ÂèÇËÄÉ¬†<a href="https://gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html">Statements and Declarations in Expressions</a>„ÄÇÂ§çÂêàËØ≠Âè•‰∏≠ÁöÑÊúÄÂêé‰∏ÄÈ°πÂ∫îËØ•ÊòØ‰∏Ä‰∏™Ë°®ËææÂºèÔºåÂêéË∑ü‰∏Ä‰∏™ÂàÜÂè∑¬†<code>;</code>„ÄÇËØ•Â≠êË°®ËææÂºèÁöÑÂÄºÁî®‰ΩúÊï¥‰∏™ËØ≠Âè•ÁöÑÂÄºÔºåÂèØ‰ª•Áî®Êù•ÂÆûÁé∞Á±ª‰ºº‚ÄúËøîÂõûÂÄº‚ÄùÁöÑÊïàÊûú„ÄÇ</p>
<h3 id="_5">ÁºñËØëÁöÑÁü•ËØÜ</h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ËøôÂùóÊù•Ëá™‰∫éÂØπ lab1 ÊñáÊ°£ÁöÑÊï¥ÁêÜ„ÄÇÂ∏åÊúõÊúâÊï¥ÁêÜÂæóÊØîÂéüÊñáÊ°£ÂèØËØª‰∏Ä‰∫õ„ÄÇ</p>
</div>
<p>`vmlinux.lds`` ÊòØ GNU ldÔºå‰∏ÄÁßçÈìæÊé•Âô®ÔºåÂ∞Ü .o Êñá‰ª∂ÂíåÂ∫ìÊñá‰ª∂ËøûÊé•Ëµ∑Êù•ÊàêÂèØÊâßË°åÊñá‰ª∂„ÄÇld‰ΩøÁî®ÈìæÊé•ËÑöÊú¨linker scriptÊéßÂà∂„ÄÇËøô‰∏™Êñá‰ª∂ÈáåÊúâÂÜôÔºö</p>
<ul>
<li>ÁõÆÊ†áÊû∂ÊûÑ <code>OUTPUT_ARCH( "riscv" )</code></li>
<li>Á®ãÂ∫èÂÖ•Âè£Ôºö <code>ENTRY( _start )</code>Âπ∂‰∏îhead.SÈáåÈúÄË¶ÅÁºñÂÜôÂØπÂ∫îÁöÑ_startÂáΩÊï∞</li>
<li>kernel‰ª£Á†ÅËµ∑ÂßãÂú∞ÂùÄ <code>BASE_ADDR = 0x80200000;</code></li>
<li>ÊØè‰∏™ÊÆµÁöÑËµ∑ÂßãÂú∞ÂùÄ ÁªìÊùüÂú∞ÂùÄ ÂØπÈΩêÊñπÂºè</li>
<li>kernel‰ª£Á†ÅÁªìÊùüÂú∞ÂùÄ</li>
</ul>
<p>Êàë‰ª¨ÈòÖËØª‰∏Ä‰∏ãËøô‰∏™ÈìæÊé•Âô®Êñá‰ª∂ÔºåÂØπ‰πãÂêéÁöÑÂÆûÈ™åÂ∏ÆÂä©Êå∫Â§ß„ÄÇ</p>
<p>È¶ñÂÖàÂèØ‰ª•Á≤óÁï•ËßÇÂØüÂà∞Ôºåkernel Á©∫Èó¥ÈáåÊòØÂàÜÊÆµ(secition)ÁöÑÔºå‰∏ªË¶ÅÁöÑsectionÊúâÔºö</p>
<table>
<thead>
<tr>
<th>ÊÆµÂêç</th>
<th>‰∏ªË¶Å‰ΩúÁî®</th>
</tr>
</thead>
<tbody>
<tr>
<td>.text</td>
<td>ÈÄöÂ∏∏Â≠òÊîæÁ®ãÂ∫èÊâßË°å‰ª£Á†Å</td>
</tr>
<tr>
<td>.rodata</td>
<td>ÈÄöÂ∏∏Â≠òÊîæÂ∏∏ÈáèÁ≠âÂè™ËØªÊï∞ÊçÆ</td>
</tr>
<tr>
<td>.data</td>
<td>ÈÄöÂ∏∏Â≠òÊîæÂ∑≤ÂàùÂßãÂåñÁöÑÂÖ®Â±ÄÂèòÈáè ÈùôÊÄÅÂèòÈáè</td>
</tr>
<tr>
<td>.bss</td>
<td>ÈÄöÂ∏∏Â≠òÊîæÊú™ÂàùÂßãÂåñÁöÑÂÖ®Â±ÄÂèòÈáè ÈùôÊÄÅÂèòÈáè</td>
</tr>
</tbody>
</table>
<p>ÂÜçÁªÜËá¥‰∏ÄÁÇπÂéªËßÇÂØüÈáåÈù¢ÁöÑÁ¨¶Âè∑„ÄÇ</p>
<ul>
<li>Á¨¶Âè∑ <code>.</code> Âú®ÈìæÊé•ËÑöÊú¨‰ª£Ë°®ÂΩìÂâçÂú∞ÂùÄÔºåÂÆÉÊúâËµãÂÄº„ÄÅË¢´ËµãÂÄº„ÄÅËá™Â¢ûÁ≠âÊìç‰Ωú„ÄÇ</li>
<li>Á¨¶Âè∑ <code>*</code> Êúâ‰∏§ÁßçÁî®Ê≥ïÔºåÂÖ∂‰∏ÄÊòØ <code>*()</code> Âú®Â§ßÊã¨Âè∑‰∏≠Ë°®Á§∫Â∞ÜÊâÄÊúâÊñá‰ª∂‰∏≠Á¨¶ÂêàÊã¨Âè∑ÂÜÖË¶ÅÊ±ÇÁöÑÊÆµÊîæÁΩÆÂú®ÂΩìÂâç‰ΩçÁΩÆ <code>*(.data .data.*)</code>ÔºåÂÖ∂‰∫åÊòØ‰Ωú‰∏∫ÈÄöÈÖçÁ¨¶„ÄÇ</li>
<li>Âú®ÈìæÊé•ËÑöÊú¨‰∏≠ËøòÂèØ‰ª•Ëá™ÂÆö‰πâÁ¨¶Âè∑Ôºå‰æãÂ¶ÇÊñá‰ª∂ÈáåÊâÄÊúâ¬†<code>_s</code>¬†‰∏é¬†<code>_e</code>ÂºÄÂ§¥ÁöÑÁ¨¶Âè∑ÈÉΩÊòØÊú¨ÂÆûÈ™åÂä©ÊïôËÄÅÂ∏àËá™Â∑±ÂÆö‰πâÁöÑ„ÄÇ</li>
</ul>
<p>ÁºñËØëÂá∫ÁöÑÊñá‰ª∂ÈáåÔºö</p>
<ul>
<li>vmlinux ÈÄöÂ∏∏Êåá Linux Kernel ÁºñËØëÂá∫ÁöÑÂèØÊâßË°åÊñá‰ª∂ (Executable and Linkable Format / ELF)ÔºåÁâπÁÇπÊòØÊú™ÂéãÁº©ÁöÑÔºåÂ∏¶Ë∞ÉËØï‰ø°ÊÅØÂíåÁ¨¶Âè∑Ë°®ÁöÑ„ÄÇ</li>
<li>System.map ÊòØÂÜÖÊ†∏Á¨¶Âè∑Ë°®ÔºàKernel Symbol TableÔºâÊñá‰ª∂ÔºåÊòØÂ≠òÂÇ®‰∫ÜÊâÄÊúâÂÜÖÊ†∏Á¨¶Âè∑ÂèäÂÖ∂Âú∞ÂùÄÁöÑ‰∏Ä‰∏™ÂàóË°®„ÄÇ‚ÄúÁ¨¶Âè∑‚ÄùÈÄöÂ∏∏ÊåáÁöÑÊòØÂáΩÊï∞ÂêçÔºåÂÖ®Â±ÄÂèòÈáèÂêçÁ≠âÁ≠â„ÄÇ‰ΩøÁî®¬†<code>nm vmlinux</code>¬†ÂëΩ‰ª§Âç≥ÂèØÊâìÂç∞ vmlinux ÁöÑÁ¨¶Âè∑Ë°®„ÄÇ</li>
</ul>
<h3 id="risc-v">RISC-V Êó∂Èíü‰∏≠Êñ≠</h3>
<p>Êìç‰ΩúÁ≥ªÁªüÂú®ÂêØÂä®ÂêéÁî±‰∫ã‰ª∂(event)È©±Âä®ÔºåÊàë‰ª¨Â∞ÜÂºïÂÖ•‰∏ÄÁßç‰∫ã‰ª∂trapÔºåtrapÁªô‰∫Üos‰∏éËΩØÁ°¨‰ª∂‰∫§‰∫íÁöÑËÉΩÂäõ„ÄÇÂú®bootÈò∂ÊÆµopensbiÂÆûÁé∞‰∫ÜMÊÄÅÁöÑtrapÂ§ÑÁêÜ„ÄÇÊàë‰ª¨ÂÆûÁé∞ÁöÑÊòØsÊÄÅÁöÑtrapÂ§ÑÁêÜ„ÄÇ</p>
<p>Âπ∂‰∏îÊàë‰ª¨ÊòéÁ°Æ‰∏Ä‰∏ã Interrupt, Exception Âíå Trap ÁöÑÂå∫Âà´ (from riscv unprivileged spec)Ôºö</p>
<ul>
<li>Interrupt: an external asynchronous (ÂºÇÊ≠•ÁöÑ) event that may cause a riscv hart to experience an unexpected transfer of control.</li>
<li>Exception: an unusual condition occurring at run time associated with an instruction in the current riscv hart.</li>
<li>Trap: the transfer of control to a trap handler caused by either an exception or an interrupt</li>
</ul>
<p>ÂÆûÈ™åÊâãÂÜåÂàôÁªô‰∫Ü‰∏ãË°®ÔºåËôΩÁÑ∂ÈáåÈù¢Ê≤°ÊúâËÆ≤Âà∞ trapÔºå‰ΩÜÊòØËøô‰∏™ÂØπ‰∫é interrupt Âíå exception ÁöÑËß£ÈáäÊõ¥Ê∏ÖÊ•ö„ÄÇ</p>
<table>
<thead>
<tr>
<th>Interrupt</th>
<th>Exception</th>
</tr>
</thead>
<tbody>
<tr>
<td>hardware generated</td>
<td>software generated</td>
</tr>
<tr>
<td>Asynchronous external requests (generated by e.g. keyboard or printer)</td>
<td>synchronous internal requests for services based upon abnormal events (generated by e.g. illegal instructions, illegal address, overflow, etc.)</td>
</tr>
<tr>
<td>normal events</td>
<td>abnormal events</td>
</tr>
</tbody>
</table>
<p>ÁêÜËß£‰∫Ü‰∏äËø∞‰∏§‰∏™Ê¶ÇÂøµÂêéÂèØ‰ª•Êää trap ÂΩì‰Ωú‰∏ÄÁßçÁªüÁß∞ÔºåÂèØ‰ª•ÁêÜËß£‰∏∫ trap = interrupt + exception„ÄÇÊàë‰ª¨ÂêéÁª≠ÂÆûÁé∞ÁöÑ <code>trap_handler()</code> Êó¢Ë¶ÅÂ§ÑÁêÜ‰∏≠Êñ≠‰πüË¶ÅÂ§ÑÁêÜÂºÇÂ∏∏„ÄÇ</p>
<p>Ë¶ÅÂÆûÁé∞ÁöÑ‰∏≠Êñ≠ÁöÑÊµÅÁ®ãÂ¶Ç‰∏ãÔºåÂèØ‰ª•ÂèÇÁÖßËøô‰∏™ÂÆåÊàê <code>do_timer()</code> <code>switch_to()</code> <code>schedule()</code> Á≠âÂáΩÊï∞Ôºö</p>
<ul>
<li>Âú®ÊØèÊ¨°Â§ÑÁêÜÊó∂Èíü‰∏≠Êñ≠Êó∂ÔºåÊìç‰ΩúÁ≥ªÁªüÈ¶ñÂÖà‰ºöÂ∞ÜÂΩìÂâçÁ∫øÁ®ãÁöÑËøêË°åÂâ©‰ΩôÊó∂Èó¥ÂáèÂ∞ë‰∏Ä‰∏™Âçï‰Ωç„ÄÇ‰πãÂêéÊ†πÊçÆË∞ÉÂ∫¶ÁÆóÊ≥ïÊù•Á°ÆÂÆöÊòØÁªßÁª≠ËøêË°åËøòÊòØË∞ÉÂ∫¶ÂÖ∂‰ªñÁ∫øÁ®ãÊù•ÊâßË°å„ÄÇ</li>
<li>Âú®ËøõÁ®ãË∞ÉÂ∫¶Êó∂ÔºåÊìç‰ΩúÁ≥ªÁªü‰ºöÈÅçÂéÜÊâÄÊúâÂèØËøêË°åÁöÑÁ∫øÁ®ãÔºåÊåâÁÖß‰∏ÄÂÆöÁöÑË∞ÉÂ∫¶ÁÆóÊ≥ïÈÄâÂá∫‰∏ã‰∏Ä‰∏™ÊâßË°åÁöÑÁ∫øÁ®ã„ÄÇÊúÄÁªàÂ∞ÜÈÄâÊã©ÂæóÂà∞ÁöÑÁ∫øÁ®ã‰∏éÂΩìÂâçÁ∫øÁ®ãÂàáÊç¢„ÄÇ</li>
<li>Âú®ÂàáÊç¢ÁöÑËøáÁ®ã‰∏≠ÔºåÈ¶ñÂÖàÊàë‰ª¨ÈúÄË¶Å‰øùÂ≠òÂΩìÂâçÁ∫øÁ®ãÁöÑÊâßË°å‰∏ä‰∏ãÊñáÔºåÂÜçÂ∞ÜÂ∞ÜË¶ÅÊâßË°åÁ∫øÁ®ãÁöÑ‰∏ä‰∏ãÊñáËΩΩÂÖ•Âà∞Áõ∏ÂÖ≥ÂØÑÂ≠òÂô®‰∏≠ÔºåËá≥Ê≠§Êàë‰ª¨Â∞±ÂÆåÊàê‰∫ÜÁ∫øÁ®ãÁöÑË∞ÉÂ∫¶‰∏éÂàáÊç¢„ÄÇ</li>
</ul>
<h3 id="riscv">RISCV ÂØÑÂ≠òÂô®</h3>
<p>ÂõûÂøÜÂÜÖÂ≠òÁªìÊûÑÔºàÂ¶ÇÊûú‰Ω†ÊòéÁ°ÆÁü•ÈÅìÂØÑÂ≠òÂô®ÊòØ‰ªÄ‰πàÂ∞±‰∏çÁî®ÂõûÂøÜ‰∫ÜÔºâÔºåÂèØËßÅÂØÑÂ≠òÂô®Âπ∂‰∏çÂú®ËøêË°åÂÜÖÂ≠òÈáåÔºö</p>
<p>```plain text</p>
<p>Â∞è/Âø´ &lt;---------------&gt; Â§ß/ÊÖ¢
[ÂØÑÂ≠òÂô®] - [cache] - [ÂÜÖÂ≠ò] - [Â§ñÂ≠ò]</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>riscvÊúâ32‰∏™ÈÄöÁî®ÂØÑÂ≠òÂô® + ÂæàÂ§öÊéßÂà∂Áä∂ÊÄÅÂØÑÂ≠òÂô® (control and status registers (CSRs))„ÄÇriscv ÁªôÊØè‰∏™ÂØÑÂ≠òÂô®Êúâ‰∏™ÂÖÉ‰ø°ÊÅØÔºåËøô‰∏™ÂÖÉ‰ø°ÊÅØÂÖ±Áî® 12-bit Êù•Â≠òÂÇ®Âç≥ csr[11:0]ÔºåÊâÄ‰ª•‰∏ÄÂÖ±ÊîØÊåÅ 4096 ‰∏™ÂØÑÂ≠òÂô®„ÄÇÂÖ∑‰ΩìËÄåË®ÄÔºåcsr[11:0] Ëøô‰∏™Êï∞ÊçÆÁªìÊûÑÊØè‰∏™‰ΩçÁöÑÊÑè‰πâÂàÜÈÖçÂ¶Ç‰∏ãÔºö
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>| ‰ΩçÊï∞ | 11:10 | 9:8 | 7:4 |
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>| --- | --- | --- | --- |
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>| ÈïøÂ∫¶ | 2 | 2 | 4 |
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>| ‰ΩúÁî® | 11=read-onlyÔºåother=read/writeÔºü | ËÉΩËÆøÈóÆËØ•csrÁöÑÊúÄ‰ΩéÁöÑÊùÉÈôêÊ®°Âºè | ÊàëÁåúÊòØ‰øùÁïôÁªôÊØè‰∏™csrÁâπÂÆöÁöÑ |
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>È¶ñÂÖàÔºåÈÄöÁî®ÂØÑÂ≠òÂô®ÊúâÂ¶Ç‰∏ãËøô‰∫õÔºö
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>TODOÔºö‰∏Ä‰∏™ÂØÑÂ≠òÂô®ÁöÑÂàóË°®ÁöÑÊà™Âõæ
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>Âú®ÁºñÂÜôÊ±áÁºñ‰ª£Á†ÅÁöÑÊó∂ÂÄô‰∏ÄËà¨‰ΩøÁî®ÂØÑÂ≠òÂô®ÁöÑabiÁöÑÂêçÂ≠óËÄå‰∏çÊòØÂØÑÂ≠òÂô®ÁöÑÁºñÂè∑
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>- x0 - x31ÊòØÁî®Êù•ÂÅöÊï¥ÂΩ¢ËøêÁÆóÁöÑÂØÑÂ≠òÂô®
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>- f0 - f31ÊòØÁî®Êù•ÂÅöÊµÆÁÇπËøêÁÆóÁöÑÂØÑÂ≠òÂô®ÔºàÊúâÁöÑ‰∏ç‰∏ÄÂÆöÊúâÔºâ
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>ËÄå‰∏ãÈù¢Ë¶ÅÂçïÁã¨ËÆ≤‰∏Ä‰∏ã **csr**„ÄÇ
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a>!!! warning
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>    Êàë‰∏çÁü•ÈÅì‰∏ãÈù¢ÁöÑÂõæÁâá‰Ωú‰∏∫ notion ÂÜÖÈÉ®ÈìæÊé•ËÉΩÂê¶Ê≠£Â∏∏Êü•ÁúãÔºåÊÄª‰πãÊàë‰ºöÂ∞ΩÂø´ÊääÂõæÁâáÂèòÊàêÊú¨Âú∞ÂõæÁâáÊù• fix„ÄÇ
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a>**sstatus (supervisor status register)**
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a>The sstatus register is an SXLEN(‰ª£Ë°®32Êàñ64)-bit read/write register formatted as follows. Êàë‰ª¨Áî®ÁöÑÊòØ64‰Ωç„ÄÇ
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a>![Êà™Â±è2023-12-22 16.03.00.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/a3eb604e-abb0-49ff-b3ae-be1989ce8ab0/c19de790-9471-46d8-9b8c-5d800024e979/%E6%88%AA%E5%B1%8F2023-12-22_16.03.00.png)
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a>‰πüÂ∞±ÊòØËØ¥Ëøô‰∏™ÂØÑÂ≠òÂô®ÊääÂæàÂ§ö‰∫ã‰ª∂ÁöÑÁä∂ÊÄÅÈÉΩÁî®0Êàñ1Ë°®Á§∫ÔºåÊãºÂà∞‰∫ÜÂêå‰∏Ä‰∏™ÂØÑÂ≠òÂô®Èáå„ÄÇ
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a>
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a>| ‰ΩçÊï∞ | ÂêçÁß∞ | ÁΩÆ1Ë°®Á§∫ | ÁΩÆ0Ë°®Á§∫ |
</span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a>| --- | --- | --- | --- |
</span><span id="__span-8-33"><a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a>| 1 | SIE | ÂìçÂ∫îÊâÄÊúâÁöÑSÊÄÅtrap | Á¶ÅÁî®ÊâÄÊúâSÊÄÅtrap |
</span><span id="__span-8-34"><a id="__codelineno-8-34" name="__codelineno-8-34" href="#__codelineno-8-34"></a>| 5 | SPIE | Âú®trapÂèëÁîüÂâçÁöÑSIE=1 | Âú®trapÂèëÁîüÂâçÁöÑSIE=0 |
</span><span id="__span-8-35"><a id="__codelineno-8-35" name="__codelineno-8-35" href="#__codelineno-8-35"></a>| 8 | SPP | ÂΩì‰∏≠Êñ≠ÂèëÁîüÂÆåÁöÑÊó∂ÂÄôÔºåËøîÂõûÂà∞S-mode | ÂΩì‰∏≠Êñ≠ÂèëÁîüÂÆåÁöÑÊó∂ÂÄôÔºåËøîÂõûÂà∞U-mode |
</span><span id="__span-8-36"><a id="__codelineno-8-36" name="__codelineno-8-36" href="#__codelineno-8-36"></a>
</span><span id="__span-8-37"><a id="__codelineno-8-37" name="__codelineno-8-37" href="#__codelineno-8-37"></a>ÊâãÂÜåÈáåËøò‰ªãÁªçÁöÑ‰ΩçÊúâ
</span><span id="__span-8-38"><a id="__codelineno-8-38" name="__codelineno-8-38" href="#__codelineno-8-38"></a>
</span><span id="__span-8-39"><a id="__codelineno-8-39" name="__codelineno-8-39" href="#__codelineno-8-39"></a>- MXR: memory privilege.
</span><span id="__span-8-40"><a id="__codelineno-8-40" name="__codelineno-8-40" href="#__codelineno-8-40"></a>- WARL: endianness control
</span><span id="__span-8-41"><a id="__codelineno-8-41" name="__codelineno-8-41" href="#__codelineno-8-41"></a>
</span><span id="__span-8-42"><a id="__codelineno-8-42" name="__codelineno-8-42" href="#__codelineno-8-42"></a>**sie (supervisor interrupt enable register)**
</span><span id="__span-8-43"><a id="__codelineno-8-43" name="__codelineno-8-43" href="#__codelineno-8-43"></a>
</span><span id="__span-8-44"><a id="__codelineno-8-44" name="__codelineno-8-44" href="#__codelineno-8-44"></a>Â¶ÇÊûúÂºÄÂêØ‰∫Üsstatus[SIE]ÔºåÂ∞±‰ºöÊ†πÊçÆsie‰∏≠ÁöÑÊØîÁâπ‰ΩçÔºåÂÜ≥ÂÆöÊòØÂê¶Â§ÑÁêÜinterrupt
</span><span id="__span-8-45"><a id="__codelineno-8-45" name="__codelineno-8-45" href="#__codelineno-8-45"></a>
</span><span id="__span-8-46"><a id="__codelineno-8-46" name="__codelineno-8-46" href="#__codelineno-8-46"></a>![Êà™Â±è2023-12-22 16.17.00.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/a3eb604e-abb0-49ff-b3ae-be1989ce8ab0/9a2f9d95-ddb1-4437-a479-4287cee94ebd/%E6%88%AA%E5%B1%8F2023-12-22_16.17.00.png)
</span><span id="__span-8-47"><a id="__codelineno-8-47" name="__codelineno-8-47" href="#__codelineno-8-47"></a>
</span><span id="__span-8-48"><a id="__codelineno-8-48" name="__codelineno-8-48" href="#__codelineno-8-48"></a>Bits sip.SEIP and sie.SEIE are the interrupt-pending and interrupt-enable bits for supervisor- level external interrupts. If implemented, SEIP is read-only in sip, and is set and cleared by the execution environment, typically through a platform-specific interrupt controller.
</span><span id="__span-8-49"><a id="__codelineno-8-49" name="__codelineno-8-49" href="#__codelineno-8-49"></a>Bits sip.STIP and sie.STIE are the interrupt-pending and interrupt-enable bits for supervisor- level timer interrupts. If implemented, STIP is read-only in sip, and is set and cleared by the execution environment.
</span><span id="__span-8-50"><a id="__codelineno-8-50" name="__codelineno-8-50" href="#__codelineno-8-50"></a>Bits sip.SSIP and sie.SSIE are the interrupt-pending and interrupt-enable bits for supervisor- level software interrupts. If implemented, SSIP is writable in sip and may also be set to 1 by a platform-specific interrupt controller.
</span><span id="__span-8-51"><a id="__codelineno-8-51" name="__codelineno-8-51" href="#__codelineno-8-51"></a>
</span><span id="__span-8-52"><a id="__codelineno-8-52" name="__codelineno-8-52" href="#__codelineno-8-52"></a>**stvec (supervisor trap vector base address register)**
</span><span id="__span-8-53"><a id="__codelineno-8-53" name="__codelineno-8-53" href="#__codelineno-8-53"></a>
</span><span id="__span-8-54"><a id="__codelineno-8-54" name="__codelineno-8-54" href="#__codelineno-8-54"></a>‰∏≠Êñ≠ÂêëÈáèË°®Âü∫ÂùÄ. 
</span><span id="__span-8-55"><a id="__codelineno-8-55" name="__codelineno-8-55" href="#__codelineno-8-55"></a>
</span><span id="__span-8-56"><a id="__codelineno-8-56" name="__codelineno-8-56" href="#__codelineno-8-56"></a>![Êà™Â±è2023-12-22 16.11.56.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/a3eb604e-abb0-49ff-b3ae-be1989ce8ab0/df6c9965-4ba3-45af-a9e6-70a9c05920f1/%E6%88%AA%E5%B1%8F2023-12-22_16.11.56.png)
</span><span id="__span-8-57"><a id="__codelineno-8-57" name="__codelineno-8-57" href="#__codelineno-8-57"></a>
</span><span id="__span-8-58"><a id="__codelineno-8-58" name="__codelineno-8-58" href="#__codelineno-8-58"></a>WARLÊòØ‰∏≠Êñ≠Â§ÑÁêÜÁ®ãÂ∫èÁöÑÂú∞ÂùÄ
</span><span id="__span-8-59"><a id="__codelineno-8-59" name="__codelineno-8-59" href="#__codelineno-8-59"></a>
</span><span id="__span-8-60"><a id="__codelineno-8-60" name="__codelineno-8-60" href="#__codelineno-8-60"></a>MODEÊòØ
</span><span id="__span-8-61"><a id="__codelineno-8-61" name="__codelineno-8-61" href="#__codelineno-8-61"></a>
</span><span id="__span-8-62"><a id="__codelineno-8-62" name="__codelineno-8-62" href="#__codelineno-8-62"></a>| Value | mode | ÊèèËø∞ |
</span><span id="__span-8-63"><a id="__codelineno-8-63" name="__codelineno-8-63" href="#__codelineno-8-63"></a>| --- | --- | --- |
</span><span id="__span-8-64"><a id="__codelineno-8-64" name="__codelineno-8-64" href="#__codelineno-8-64"></a>| 0 | Direct Ê®°Âºè | ÈÄÇÁî®‰∫éÁ≥ªÁªü‰∏≠Âè™Êúâ‰∏Ä‰∏™‰∏≠Êñ≠Â§ÑÁêÜÁ®ãÂ∫è, ÂÖ∂ÊåáÂêë‰∏≠Êñ≠Â§ÑÁêÜÂÖ•Âè£ÂáΩÊï∞ Ôºà Êú¨ÂÆûÈ™å‰∏≠Êàë‰ª¨ÊâÄÁî®ÁöÑÊ®°Âºè Ôºâ |
</span><span id="__span-8-65"><a id="__codelineno-8-65" name="__codelineno-8-65" href="#__codelineno-8-65"></a>| 1 | VectoredÊ®°Âºè | ÊåáÂêë‰∏≠Êñ≠ÂêëÈáèË°®Ôºå ÈÄÇÁî®‰∫éÁ≥ªÁªü‰∏≠ÊúâÂ§ö‰∏™‰∏≠Êñ≠Â§ÑÁêÜÁ®ãÂ∫è |
</span><span id="__span-8-66"><a id="__codelineno-8-66" name="__codelineno-8-66" href="#__codelineno-8-66"></a>| ‚â•2 | ‰øùÁïô |  |
</span><span id="__span-8-67"><a id="__codelineno-8-67" name="__codelineno-8-67" href="#__codelineno-8-67"></a>
</span><span id="__span-8-68"><a id="__codelineno-8-68" name="__codelineno-8-68" href="#__codelineno-8-68"></a>**scause (supervisor cause register)**
</span><span id="__span-8-69"><a id="__codelineno-8-69" name="__codelineno-8-69" href="#__codelineno-8-69"></a>
</span><span id="__span-8-70"><a id="__codelineno-8-70" name="__codelineno-8-70" href="#__codelineno-8-70"></a>‰ºöËÆ∞ÂΩï trap ÂèëÁîüÁöÑÂéüÂõ†ÔºåËøò‰ºöËÆ∞ÂΩïËØ• trapÊòØ¬†`Interrupt`¬†ËøòÊòØ¬†`Exception`„ÄÇ
</span><span id="__span-8-71"><a id="__codelineno-8-71" name="__codelineno-8-71" href="#__codelineno-8-71"></a>
</span><span id="__span-8-72"><a id="__codelineno-8-72" name="__codelineno-8-72" href="#__codelineno-8-72"></a>**sscratch (supervisor scratch register)**
</span><span id="__span-8-73"><a id="__codelineno-8-73" name="__codelineno-8-73" href="#__codelineno-8-73"></a>
</span><span id="__span-8-74"><a id="__codelineno-8-74" name="__codelineno-8-74" href="#__codelineno-8-74"></a>Typically, sscratch is used to hold a pointer to the hart-local supervisor context while the hart is executing user mode. At the beginning of a trap handler, sscratch is swapped with a user register to provide an initial working register.
</span><span id="__span-8-75"><a id="__codelineno-8-75" name="__codelineno-8-75" href="#__codelineno-8-75"></a>
</span><span id="__span-8-76"><a id="__codelineno-8-76" name="__codelineno-8-76" href="#__codelineno-8-76"></a>![Êà™Â±è2023-12-22 16.25.34.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/a3eb604e-abb0-49ff-b3ae-be1989ce8ab0/4b8b7b1d-90ef-427d-ab05-989ec67fc5a0/%E6%88%AA%E5%B1%8F2023-12-22_16.25.34.png)
</span><span id="__span-8-77"><a id="__codelineno-8-77" name="__codelineno-8-77" href="#__codelineno-8-77"></a>
</span><span id="__span-8-78"><a id="__codelineno-8-78" name="__codelineno-8-78" href="#__codelineno-8-78"></a>Âú®Êú¨Ê¨°ÂÆûÈ™å‰∏≠ÔºåÊàë‰ª¨ÊãøsscratchËÆ∞ÂΩïs-modeÁöÑstack pointerÔºåÂú®trapÂèëÁîüÁöÑÊó∂ÂÄô‰∏éu-mode stack pointer‰∫§Êç¢ÔºàÂ•ΩÂÉèÊòØÊù•ÁùÄÂøò‰∫ÜTODO‰∏Ä‰ºöÊ†∏ÂÆûÔºâ
</span><span id="__span-8-79"><a id="__codelineno-8-79" name="__codelineno-8-79" href="#__codelineno-8-79"></a>
</span><span id="__span-8-80"><a id="__codelineno-8-80" name="__codelineno-8-80" href="#__codelineno-8-80"></a>**sepc (supervisor exception program counter)**
</span><span id="__span-8-81"><a id="__codelineno-8-81" name="__codelineno-8-81" href="#__codelineno-8-81"></a>
</span><span id="__span-8-82"><a id="__codelineno-8-82" name="__codelineno-8-82" href="#__codelineno-8-82"></a>Âú®s-modeÈáåÔºå‰ºöËÆ∞ÂΩïËß¶Âèë exception ÁöÑÈÇ£Êù°Êåá‰ª§ÁöÑËôöÊãüÂú∞ÂùÄÔºåËôΩÁÑ∂ÊúÄ‰Ωé‰ΩçÊÄª‰∏∫0
</span><span id="__span-8-83"><a id="__codelineno-8-83" name="__codelineno-8-83" href="#__codelineno-8-83"></a>
</span><span id="__span-8-84"><a id="__codelineno-8-84" name="__codelineno-8-84" href="#__codelineno-8-84"></a>![Êà™Â±è2023-12-22 16.28.07.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/a3eb604e-abb0-49ff-b3ae-be1989ce8ab0/00a1bf77-a91d-451b-85ff-f0b0bb598dc1/%E6%88%AA%E5%B1%8F2023-12-22_16.28.07.png)
</span><span id="__span-8-85"><a id="__codelineno-8-85" name="__codelineno-8-85" href="#__codelineno-8-85"></a>
</span><span id="__span-8-86"><a id="__codelineno-8-86" name="__codelineno-8-86" href="#__codelineno-8-86"></a>**scause (supervisor cause register)**
</span><span id="__span-8-87"><a id="__codelineno-8-87" name="__codelineno-8-87" href="#__codelineno-8-87"></a>
</span><span id="__span-8-88"><a id="__codelineno-8-88" name="__codelineno-8-88" href="#__codelineno-8-88"></a>![Êà™Â±è2023-12-22 16.30.34.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/a3eb604e-abb0-49ff-b3ae-be1989ce8ab0/2c536a76-0998-4991-bbd9-d3b29b079909/%E6%88%AA%E5%B1%8F2023-12-22_16.30.34.png)
</span><span id="__span-8-89"><a id="__codelineno-8-89" name="__codelineno-8-89" href="#__codelineno-8-89"></a>
</span><span id="__span-8-90"><a id="__codelineno-8-90" name="__codelineno-8-90" href="#__codelineno-8-90"></a>ËÆ∞ÂΩïtrapÂèëÁîüÁöÑÂéüÂõ†ÔºåÂéüÂõ†Êúâ‰ª•‰∏ãÂá†ÁßçÔºö
</span><span id="__span-8-91"><a id="__codelineno-8-91" name="__codelineno-8-91" href="#__codelineno-8-91"></a>
</span><span id="__span-8-92"><a id="__codelineno-8-92" name="__codelineno-8-92" href="#__codelineno-8-92"></a>![Êà™Â±è2023-12-22 16.32.43.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/a3eb604e-abb0-49ff-b3ae-be1989ce8ab0/bf99120a-2b6d-426d-aa6a-acb3bd0be7d6/%E6%88%AA%E5%B1%8F2023-12-22_16.32.43.png)
</span><span id="__span-8-93"><a id="__codelineno-8-93" name="__codelineno-8-93" href="#__codelineno-8-93"></a>
</span><span id="__span-8-94"><a id="__codelineno-8-94" name="__codelineno-8-94" href="#__codelineno-8-94"></a>**stval (supervisor trap value register)**
</span><span id="__span-8-95"><a id="__codelineno-8-95" name="__codelineno-8-95" href="#__codelineno-8-95"></a>
</span><span id="__span-8-96"><a id="__codelineno-8-96" name="__codelineno-8-96" href="#__codelineno-8-96"></a>![Êà™Â±è2023-12-22 16.33.29.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/a3eb604e-abb0-49ff-b3ae-be1989ce8ab0/c7b7ed51-5e53-409c-80de-e3afbae2222d/%E6%88%AA%E5%B1%8F2023-12-22_16.33.29.png)
</span><span id="__span-8-97"><a id="__codelineno-8-97" name="__codelineno-8-97" href="#__codelineno-8-97"></a>
</span><span id="__span-8-98"><a id="__codelineno-8-98" name="__codelineno-8-98" href="#__codelineno-8-98"></a>The stval register can optionally also be used to return the faulting instruction bits on an illegal
</span><span id="__span-8-99"><a id="__codelineno-8-99" name="__codelineno-8-99" href="#__codelineno-8-99"></a>instruction exception (sepc points to the faulting instruction in memory). If stval is written with
</span><span id="__span-8-100"><a id="__codelineno-8-100" name="__codelineno-8-100" href="#__codelineno-8-100"></a>a nonzero value when an illegal-instruction exception occurs, then stval will contain the shortest
</span><span id="__span-8-101"><a id="__codelineno-8-101" name="__codelineno-8-101" href="#__codelineno-8-101"></a>of:
</span><span id="__span-8-102"><a id="__codelineno-8-102" name="__codelineno-8-102" href="#__codelineno-8-102"></a>
</span><span id="__span-8-103"><a id="__codelineno-8-103" name="__codelineno-8-103" href="#__codelineno-8-103"></a>¬à the actual faulting instruction
</span><span id="__span-8-104"><a id="__codelineno-8-104" name="__codelineno-8-104" href="#__codelineno-8-104"></a>¬à the first ILEN bits of the faulting instruction
</span><span id="__span-8-105"><a id="__codelineno-8-105" name="__codelineno-8-105" href="#__codelineno-8-105"></a>¬à the first SXLEN bits of the faulting instruction
</span><span id="__span-8-106"><a id="__codelineno-8-106" name="__codelineno-8-106" href="#__codelineno-8-106"></a>
</span><span id="__span-8-107"><a id="__codelineno-8-107" name="__codelineno-8-107" href="#__codelineno-8-107"></a>The value loaded into stval on an illegal-instruction exception is right-justified and all unused upper bits are cleared to zero.
</span><span id="__span-8-108"><a id="__codelineno-8-108" name="__codelineno-8-108" href="#__codelineno-8-108"></a>
</span><span id="__span-8-109"><a id="__codelineno-8-109" name="__codelineno-8-109" href="#__codelineno-8-109"></a>**satp (supervisor address translation and protection register)**
</span><span id="__span-8-110"><a id="__codelineno-8-110" name="__codelineno-8-110" href="#__codelineno-8-110"></a>
</span><span id="__span-8-111"><a id="__codelineno-8-111" name="__codelineno-8-111" href="#__codelineno-8-111"></a>![Êà™Â±è2023-12-22 16.36.48.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/a3eb604e-abb0-49ff-b3ae-be1989ce8ab0/2de881ee-778a-4e43-a7d5-09294570e47c/%E6%88%AA%E5%B1%8F2023-12-22_16.36.48.png)
</span><span id="__span-8-112"><a id="__codelineno-8-112" name="__codelineno-8-112" href="#__codelineno-8-112"></a>
</span><span id="__span-8-113"><a id="__codelineno-8-113" name="__codelineno-8-113" href="#__codelineno-8-113"></a>ËÆ∞ÂΩïÊúÄÈ´òÁ∫ßÈ°µË°®ÁöÑÁâ©ÁêÜÂú∞ÂùÄ
</span><span id="__span-8-114"><a id="__codelineno-8-114" name="__codelineno-8-114" href="#__codelineno-8-114"></a>
</span><span id="__span-8-115"><a id="__codelineno-8-115" name="__codelineno-8-115" href="#__codelineno-8-115"></a>MODE‰Ωç=8Êó∂Ôºå‰ΩøÁî®Sv39Ê®°ÂºèËôöÊãüÂú∞ÂùÄÔºàÊú¨ÂÆûÈ™åÔºâ
</span><span id="__span-8-116"><a id="__codelineno-8-116" name="__codelineno-8-116" href="#__codelineno-8-116"></a>
</span><span id="__span-8-117"><a id="__codelineno-8-117" name="__codelineno-8-117" href="#__codelineno-8-117"></a>Êó∂Èíü‰∏≠Êñ≠Áõ∏ÂÖ≥ÁöÑÂØÑÂ≠òÂô®
</span><span id="__span-8-118"><a id="__codelineno-8-118" name="__codelineno-8-118" href="#__codelineno-8-118"></a>
</span><span id="__span-8-119"><a id="__codelineno-8-119" name="__codelineno-8-119" href="#__codelineno-8-119"></a>**mtime**
</span><span id="__span-8-120"><a id="__codelineno-8-120" name="__codelineno-8-120" href="#__codelineno-8-120"></a>
</span><span id="__span-8-121"><a id="__codelineno-8-121" name="__codelineno-8-121" href="#__codelineno-8-121"></a>ËÆ°Êó∂Âô®Ôºå‰ª•ÊÅíÂÆöÈ¢ëÁéáËá™Â¢ûÔºàÊàëËÆ∞ÂæóÂú®Êú¨ÂÆûÈ™åÈáåÊòØÂ§öÂ∞ëÂàÜ‰πã‰∏ÄÁßíÔºâ
</span><span id="__span-8-122"><a id="__codelineno-8-122" name="__codelineno-8-122" href="#__codelineno-8-122"></a>
</span><span id="__span-8-123"><a id="__codelineno-8-123" name="__codelineno-8-123" href="#__codelineno-8-123"></a>**mtimecmpÔºàmachine timer registerÔºâ**
</span><span id="__span-8-124"><a id="__codelineno-8-124" name="__codelineno-8-124" href="#__codelineno-8-124"></a>
</span><span id="__span-8-125"><a id="__codelineno-8-125" name="__codelineno-8-125" href="#__codelineno-8-125"></a>‰∏ã‰∏ÄÊ¨°Êó∂Èíü‰∏≠Êñ≠ÁöÑ‰∏≠Êñ≠ÁÇπ
</span><span id="__span-8-126"><a id="__codelineno-8-126" name="__codelineno-8-126" href="#__codelineno-8-126"></a>
</span><span id="__span-8-127"><a id="__codelineno-8-127" name="__codelineno-8-127" href="#__codelineno-8-127"></a>**mcounterenÔºàcounter enable registerÔºâ**
</span><span id="__span-8-128"><a id="__codelineno-8-128" name="__codelineno-8-128" href="#__codelineno-8-128"></a>
</span><span id="__span-8-129"><a id="__codelineno-8-129" name="__codelineno-8-129" href="#__codelineno-8-129"></a>ÔºàÊú¨ÂÆûÈ™å‰∏≠‰∏çÁî®ÁÆ°Ôºå‰ΩÜÊòØËØ¥Êòé‰∏Ä‰∏ãÔºöÔºâmtimeÊú¨Êù•ÊòØmÊÄÅÁöÑÂØÑÂ≠òÂô®ÔºåÂú®sÊÄÅ‰∏çËÉΩËØªÂÜôÔºå‰ΩÜÊòØopensbiÂ∑≤ÁªèËÆæÁΩÆËøáÂèØ‰ª•ËØªÂÜômÊÄÅ
</span><span id="__span-8-130"><a id="__codelineno-8-130" name="__codelineno-8-130" href="#__codelineno-8-130"></a>
</span><span id="__span-8-131"><a id="__codelineno-8-131" name="__codelineno-8-131" href="#__codelineno-8-131"></a>### ÂØÑÂ≠òÂô®Êìç‰Ωú
</span><span id="__span-8-132"><a id="__codelineno-8-132" name="__codelineno-8-132" href="#__codelineno-8-132"></a>
</span><span id="__span-8-133"><a id="__codelineno-8-133" name="__codelineno-8-133" href="#__codelineno-8-133"></a>Êìç‰ΩúcsrÂØÑÂ≠òÂô®ÁöÑriscvÊåá‰ª§ÈõÜ TODOÂæÖÊï¥ÁêÜ
</span><span id="__span-8-134"><a id="__codelineno-8-134" name="__codelineno-8-134" href="#__codelineno-8-134"></a>
</span><span id="__span-8-135"><a id="__codelineno-8-135" name="__codelineno-8-135" href="#__codelineno-8-135"></a>| func | scr | rs1 | rd |
</span><span id="__span-8-136"><a id="__codelineno-8-136" name="__codelineno-8-136" href="#__codelineno-8-136"></a>| --- | --- | --- | --- |
</span><span id="__span-8-137"><a id="__codelineno-8-137" name="__codelineno-8-137" href="#__codelineno-8-137"></a>|  |  |  |  |
</span><span id="__span-8-138"><a id="__codelineno-8-138" name="__codelineno-8-138" href="#__codelineno-8-138"></a>|  |  |  |  |
</span><span id="__span-8-139"><a id="__codelineno-8-139" name="__codelineno-8-139" href="#__codelineno-8-139"></a>
</span><span id="__span-8-140"><a id="__codelineno-8-140" name="__codelineno-8-140" href="#__codelineno-8-140"></a>- csrrw (CSR read and write) ,ËøôÊòØËØªÂÜôÊìç‰ΩúÔºåcsr‰∏≠ÁöÑÂÄºÂÜôÂÖ•rdÔºårs1ÁöÑÂÄºÂÜôÂÖ•csr„ÄÇ
</span><span id="__span-8-141"><a id="__codelineno-8-141" name="__codelineno-8-141" href="#__codelineno-8-141"></a>- csrrwiÊòØcsrrwÁöÑÁ´ãÂç≥Êï∞Êâ©Â±ïÔºårs1ÂØÑÂ≠òÂô®‰øùÂ≠òÂÄºÂèò‰∏∫‰∏Ä‰∏™Á´ãÂç≥Êï∞ÔºåÂØπcsrÁöÑÊìç‰ΩúÊòØ‰∏ÄËá¥ÁöÑ„ÄÇ
</span><span id="__span-8-142"><a id="__codelineno-8-142" name="__codelineno-8-142" href="#__codelineno-8-142"></a>- csrrs(CSR read and set), ËøôÊòØËØªÂπ∂ÁΩÆ‰ΩçÊìç‰ΩúÔºåcsr‰∏≠ÁöÑÂÄºÂÜôÂÖ•rdÔºå rs1ÁöÑÂÄºÊàñ‰∏ä(or)csr‰∏≠ÁöÑÂÄºÂÜçÂÜôÂÖ•csr„ÄÇ
</span><span id="__span-8-143"><a id="__codelineno-8-143" name="__codelineno-8-143" href="#__codelineno-8-143"></a>- csrrsiÊòØcsrrsÁöÑÁ´ãÂç≥Êï∞Êâ©Â±ïÔºårs1ÂØÑÂ≠òÂô®‰øùÂ≠òÂÄºÂèò‰∏∫‰∏Ä‰∏™Á´ãÂç≥Êï∞ÔºåÂØπcsrÁöÑÊìç‰ΩúÊòØ‰∏ÄËá¥ÁöÑ„ÄÇ
</span><span id="__span-8-144"><a id="__codelineno-8-144" name="__codelineno-8-144" href="#__codelineno-8-144"></a>- csrrc(CSR read and clear)ÔºåËøôÊòØËØªÂπ∂Ê∏ÖÈô§Êìç‰ΩúÔºåcsr‰∏≠ÁöÑÂÄºËØªÂÖ•rdÔºåÊ†πÊçÆrs1ÁöÑÂÄºÂØπcsr‰∏≠ÁöÑÂÄºÊåâ‰ΩçÊ∏Ö0 ÂÜçÂÜôÂÖ•csr‰∏≠„ÄÇ
</span><span id="__span-8-145"><a id="__codelineno-8-145" name="__codelineno-8-145" href="#__codelineno-8-145"></a>- csrrciÊòØcsrrcÁöÑÁ´ãÂç≥Êï∞Êâ©Â±ïÔºårs1ÂØÑÂ≠òÂô®‰øùÂ≠òÂÄºÂèò‰∏∫‰∏Ä‰∏™Á´ãÂç≥Êï∞ÔºåÂØπcsrÁöÑÊìç‰ΩúÊòØ‰∏ÄËá¥ÁöÑ„ÄÇ
</span><span id="__span-8-146"><a id="__codelineno-8-146" name="__codelineno-8-146" href="#__codelineno-8-146"></a>
</span><span id="__span-8-147"><a id="__codelineno-8-147" name="__codelineno-8-147" href="#__codelineno-8-147"></a>ÂåñÁî®‰∏Ä‰∏™ÊöÇÊó∂‰∏çÊÉ≥ÂéªÊâæÊù•Ê∫êÁöÑ CSDN Â∏ñÂ≠êÁöÑÊÄªÁªìÔºö
</span><span id="__span-8-148"><a id="__codelineno-8-148" name="__codelineno-8-148" href="#__codelineno-8-148"></a>
</span><span id="__span-8-149"><a id="__codelineno-8-149" name="__codelineno-8-149" href="#__codelineno-8-149"></a>- ÊÉ≥ÂØπcsrËøûËØªÂ∏¶ÂÜôÔºåÂèØÈÄâÁî®Âü∫Á°ÄÁöÑ6Êù°csrÊåá‰ª§Áõ¥Êé•ÊêûÂÆö.
</span><span id="__span-8-150"><a id="__codelineno-8-150" name="__codelineno-8-150" href="#__codelineno-8-150"></a>- ‰ªÖ‰ªÖÊòØËØªÁöÑËØùÔºåÂì™Êù°Âü∫Á°ÄÊåá‰ª§ÈÉΩÂèØ‰ª•Ôºå‰∏ÄËà¨‰ºöÁî®‰º™Êåá‰ª§.
</span><span id="__span-8-151"><a id="__codelineno-8-151" name="__codelineno-8-151" href="#__codelineno-8-151"></a>- ‰ª• i ÁªìÂ∞æÁöÑÔºå‰∏çÁÆ°ÊòØÂü∫Á°ÄÊåá‰ª§ËøòÊòØ‰º™Êåá‰ª§ÔºåÈÉΩÊòØÁ´ãÂç≥Êï∞‰Ωú‰∏∫ÂèÇÊï∞ÁöÑÔºåÂú®Êåá‰ª§‰∏≠Êìç‰ΩúËøô‰∏™Á´ãÂç≥Êï∞ÊõøÊç¢‰∫Ü rs1.
</span><span id="__span-8-152"><a id="__codelineno-8-152" name="__codelineno-8-152" href="#__codelineno-8-152"></a>- csrÂü∫Á°ÄÁöÑÊìç‰ΩúÔºåÂ∞±ÁÆÄÂçïÁöÑ3ÁßçÂå∫Âà´Ôºåw (Áõ¥Êé•ÂÜô )Ôºå s(ËÆæÁΩÆ) Ôºå c(Ê∏ÖÈô§)Ôºå‰∏çËÆ°iÁöÑ4Â≠óÊØçÊåá‰ª§ÈÉΩÊòØ‰º™Êåá‰ª§.
</span><span id="__span-8-153"><a id="__codelineno-8-153" name="__codelineno-8-153" href="#__codelineno-8-153"></a>- [RISC-V‰∏≠ÊñáÊâãÂÜå](http://crva.ict.ac.cn/documents/RISC-V-Reader-Chinese-v2p1.pdf)‰∏äcsrÊåá‰ª§Êúâ‰∫õÂêçÂ≠óÈîôËØØÔºå‰∏ªË¶ÅÁúãÂÜÖÂÆπÊèèËø∞.
</span><span id="__span-8-154"><a id="__codelineno-8-154" name="__codelineno-8-154" href="#__codelineno-8-154"></a>- ‰º™Êåá‰ª§‰ªÖ‰ªÖÊòØÊñπ‰æøÁ®ãÂ∫èÂëòËØªÂÜô‰ª£Á†ÅÔºåÊúÄÁªàÁºñËØëÂô®ËøòÊòØÈÉΩÁªôËΩ¨Êàê‰∫ÜÂü∫Á°ÄÊåá‰ª§.
</span><span id="__span-8-155"><a id="__codelineno-8-155" name="__codelineno-8-155" href="#__codelineno-8-155"></a>
</span><span id="__span-8-156"><a id="__codelineno-8-156" name="__codelineno-8-156" href="#__codelineno-8-156"></a>## lab2
</span><span id="__span-8-157"><a id="__codelineno-8-157" name="__codelineno-8-157" href="#__codelineno-8-157"></a>
</span><span id="__span-8-158"><a id="__codelineno-8-158" name="__codelineno-8-158" href="#__codelineno-8-158"></a>### Á∫øÁ®ã
</span><span id="__span-8-159"><a id="__codelineno-8-159" name="__codelineno-8-159" href="#__codelineno-8-159"></a>
</span><span id="__span-8-160"><a id="__codelineno-8-160" name="__codelineno-8-160" href="#__codelineno-8-160"></a>Êú¨ÂÆûÈ™åÂª∫Á´ãÁöÑÁ∫øÁ®ãÈÉΩÊòØÂÜÖÊ†∏ÊÄÅÁ∫øÁ®ã„ÄÇ‰∏Ä‰∏™‰æùÊçÆÂ∞±ÊòØÊüê‰∏™Á∫øÁ®ã trap Âêé‰∏ç‰ºöÈòªÂ°ûÂÖ∂ÂÆÉÁ∫øÁ®ã„ÄÇ
</span><span id="__span-8-161"><a id="__codelineno-8-161" name="__codelineno-8-161" href="#__codelineno-8-161"></a>
</span><span id="__span-8-162"><a id="__codelineno-8-162" name="__codelineno-8-162" href="#__codelineno-8-162"></a>Á∫øÁ®ãÁöÑ task_struct ÂèØ‰ª•ÁêÜËß£‰∏∫ÁêÜËÆ∫ËØæ‰∏äËÆ≤ÁöÑ PCB (ÊòØ‰∏çÊòØËØ•Âè´ TCBÔºü)„ÄÇÈáåÈù¢ÁöÑ‰∏úË•ø‰ºöÈöèÁùÄÈÄê‰∏™ lab Ê∑ªÂä†ËøõÂéªÔºåÊúÄÁªà‰ºöÊúâ‰ª•‰∏ã‰∏úË•øÔºö
</span><span id="__span-8-163"><a id="__codelineno-8-163" name="__codelineno-8-163" href="#__codelineno-8-163"></a>
</span><span id="__span-8-164"><a id="__codelineno-8-164" name="__codelineno-8-164" href="#__codelineno-8-164"></a>- Á∫øÁ®ãid (pid)ÔºöÁî®‰∫éÂîØ‰∏ÄÁ°ÆËÆ§‰∏Ä‰∏™Á∫øÁ®ã
</span><span id="__span-8-165"><a id="__codelineno-8-165" name="__codelineno-8-165" href="#__codelineno-8-165"></a>- ËøêË°åÊ†à (user_stack, kernel_stack)ÔºöÊØè‰∏™Á∫øÁ®ãÂøÖÈ°ªÊúâ‰∏Ä‰∏™Áã¨Á´ãÁöÑÁî®Êà∑Ê†à
</span><span id="__span-8-166"><a id="__codelineno-8-166" name="__codelineno-8-166" href="#__codelineno-8-166"></a>- ÊâßË°å‰∏ä‰∏ãÊñá (pt_regs *)ÔºöÁ∫øÁ®ã‰∏çÂú®ÊâßË°åÊó∂ÔºåÈúÄË¶Å‰øùÂ≠òÂÖ∂‰∏ä‰∏ãÊñáÔºàÁä∂ÊÄÅÂØÑÂ≠òÂô®ÁöÑÂÄºÔºâÔºåËøôÊ†∑‰πãÂêéÊâçËÉΩÊÅ¢Â§ç
</span><span id="__span-8-167"><a id="__codelineno-8-167" name="__codelineno-8-167" href="#__codelineno-8-167"></a>- ËøêË°åÊó∂Èó¥Áâá (counter)Ôºö‰∏∫ÊØè‰∏™Á∫øÁ®ãÂàÜÈÖçÁöÑËøêË°åÊó∂Èó¥
</span><span id="__span-8-168"><a id="__codelineno-8-168" name="__codelineno-8-168" href="#__codelineno-8-168"></a>- ‰ºòÂÖàÁ∫ß (priority)ÔºöÂú®ÊâßË°åÁõ∏ÂÖ≥Ë∞ÉÂ∫¶Êó∂ÔºåÈÖçÂêàË∞ÉÂ∫¶ÁÆóÊ≥ïÈÄâÂá∫‰∏ã‰∏Ä‰∏™ÊâßË°åÁöÑËøõÁ®ã
</span><span id="__span-8-169"><a id="__codelineno-8-169" name="__codelineno-8-169" href="#__codelineno-8-169"></a>- demand paging ‰∏≠Áî®Âà∞ÁöÑÊâÄÊúâ vma ‰ø°ÊÅØÔºåÂíå‰∏Ä‰∏™ÈúÄË¶ÅÁöÑ vma ‰∏™Êï∞ËÆ°Êï∞Âô®
</span><span id="__span-8-170"><a id="__codelineno-8-170" name="__codelineno-8-170" href="#__codelineno-8-170"></a>- TODOÔºöËøòÊúâÂà´ÁöÑÂêóÔºåÂêéÈù¢ÂèØ‰ª•ÂÜçÁ°ÆËÆ§‰∏Ä‰∏ã
</span><span id="__span-8-171"><a id="__codelineno-8-171" name="__codelineno-8-171" href="#__codelineno-8-171"></a>
</span><span id="__span-8-172"><a id="__codelineno-8-172" name="__codelineno-8-172" href="#__codelineno-8-172"></a>!!! warning
</span><span id="__span-8-173"><a id="__codelineno-8-173" name="__codelineno-8-173" href="#__codelineno-8-173"></a>    TODO ‰ª•‰∏ãÂÜÖÂÆπÈúÄË¶ÅÂÜçÊ£ÄÊü•ÔºåÂøΩÁÑ∂ÂàÜ‰∏çÊ∏ÖÊØè‰∏™Á∫øÁ®ãÊÄªÂÖ±ÊòØÂºÄ‰∫Ü‰∏Ä‰∏™ËøòÊòØ‰∏§‰∏™ÂÜÖÂ≠òÁ©∫Èó¥
</span><span id="__span-8-174"><a id="__codelineno-8-174" name="__codelineno-8-174" href="#__codelineno-8-174"></a>
</span><span id="__span-8-175"><a id="__codelineno-8-175" name="__codelineno-8-175" href="#__codelineno-8-175"></a>Á∫øÁ®ãÂÜÖÂ≠òÁ©∫Èó¥ÁªìÊûÑÂ¶Ç‰∏ã„ÄÇ
</span><span id="__span-8-176"><a id="__codelineno-8-176" name="__codelineno-8-176" href="#__codelineno-8-176"></a>
</span><span id="__span-8-177"><a id="__codelineno-8-177" name="__codelineno-8-177" href="#__codelineno-8-177"></a>|  | ÂÜÖÊ†∏ËôöÊãüÂ≠òÂÇ®Âô® | Áî®Êà∑‰∏çÂèØËßÅÁöÑÂ≠òÂÇ®Âô® |
</span><span id="__span-8-178"><a id="__codelineno-8-178" name="__codelineno-8-178" href="#__codelineno-8-178"></a>| --- | --- | --- |
</span><span id="__span-8-179"><a id="__codelineno-8-179" name="__codelineno-8-179" href="#__codelineno-8-179"></a>| 0xc000 0000 | Áî®Êà∑Ê†à | ‚Üê sp |
</span><span id="__span-8-180"><a id="__codelineno-8-180" name="__codelineno-8-180" href="#__codelineno-8-180"></a>|  |  |  |
</span><span id="__span-8-181"><a id="__codelineno-8-181" name="__codelineno-8-181" href="#__codelineno-8-181"></a>| 0x4000 0000 | ÂÖ±‰∫´Â∫ìÁöÑÂ≠òÂÇ®Âô®Êò†Â∞ÑÂå∫Âüü |  |
</span><span id="__span-8-182"><a id="__codelineno-8-182" name="__codelineno-8-182" href="#__codelineno-8-182"></a>|  |  |  |
</span><span id="__span-8-183"><a id="__codelineno-8-183" name="__codelineno-8-183" href="#__codelineno-8-183"></a>|  | ËøêË°åÊó∂Â†ÜÔºàÁî±mallocÂàõÂª∫Ôºâ | ‚Üê brk |
</span><span id="__span-8-184"><a id="__codelineno-8-184" name="__codelineno-8-184" href="#__codelineno-8-184"></a>|  | ËØªÂÜôÊÆµ .data .bss | ‰ªéÂèØÊâßË°åÊñá‰ª∂Âä†ËΩΩ |
</span><span id="__span-8-185"><a id="__codelineno-8-185" name="__codelineno-8-185" href="#__codelineno-8-185"></a>|  | Âè™ËØªÊÆµ .init .text .rodata | ‰ªéÂèØÊâßË°åÊñá‰ª∂Âä†ËΩΩ |
</span><span id="__span-8-186"><a id="__codelineno-8-186" name="__codelineno-8-186" href="#__codelineno-8-186"></a>| 0x0804 8000 | Êú™Áî®ÁöÑ | ‰ªéÂèØÊâßË°åÊñá‰ª∂Âä†ËΩΩ |
</span><span id="__span-8-187"><a id="__codelineno-8-187" name="__codelineno-8-187" href="#__codelineno-8-187"></a>
</span><span id="__span-8-188"><a id="__codelineno-8-188" name="__codelineno-8-188" href="#__codelineno-8-188"></a>
</span><span id="__span-8-189"><a id="__codelineno-8-189" name="__codelineno-8-189" href="#__codelineno-8-189"></a>## lab3
</span><span id="__span-8-190"><a id="__codelineno-8-190" name="__codelineno-8-190" href="#__codelineno-8-190"></a>
</span><span id="__span-8-191"><a id="__codelineno-8-191" name="__codelineno-8-191" href="#__codelineno-8-191"></a>Âà∞Êú¨ÂÆûÈ™åÁªìÊùüÊó∂ÔºåÊàë‰ª¨ÁöÑÁ®ãÂ∫èÂ∞ÜË¶ÅÂÆûÁé∞ËøôÊ†∑‰∏Ä‰∏™‰ªéÂêØÂä®Âà∞ÂºÄÂêØÊò†Â∞ÑÁöÑËøáÁ®ãÔºà‰πüÂØπÂ∫î `head.S` ÂºÄÂ§¥ÁöÑ‰∏ÄÂ†ÜÂáΩÊï∞Ë∞ÉÁî®ÊµÅÁ®ãÔºâÔºö
</span><span id="__span-8-192"><a id="__codelineno-8-192" name="__codelineno-8-192" href="#__codelineno-8-192"></a>
</span><span id="__span-8-193"><a id="__codelineno-8-193" name="__codelineno-8-193" href="#__codelineno-8-193"></a>- opensbiÂàùÂßãÂåñÈÇ£‰∏ÄÂ†Ü‰∏úË•ø bootloader
</span><span id="__span-8-194"><a id="__codelineno-8-194" name="__codelineno-8-194" href="#__codelineno-8-194"></a>- call setup_vm: Áâ©ÁêÜÂú∞ÂùÄÁøªËØëÊàêËôöÊãüÂú∞ÂùÄÔºàÁ≠âÂÄº+ÂÅèÁßªÔºâ„ÄÇÊàëÁöÑÁêÜËß£ÊòØËøô‰∏ÄÊ≠•ÊòØ‰∏∫‰∫ÜÊñπ‰æøË∞ÉËØïÔºåÂõ†‰∏∫Êàë‰ª¨‰∏ÄÂºÄÂßãÂêåÊ≠•ÁöÑvmlinux.ldsÂØºËá¥Á¨¶Âè∑Ë°®ÈáåÊâÄÊúâÁ¨¶Âè∑ÈÉΩÊòØÁî®ËôöÊãüÂú∞ÂùÄË°®Á§∫ÁöÑÔºåÂ¶ÇÊûúËøôÈáåÊ≤°Êò†Â∞ÑÂêéËæπË∞ÉËØïÂ∞±Ê≤°Ê≥ïËøõË°å„ÄÇÁ≠âÂÄºÊò†Â∞ÑÊòØÂõ†‰∏∫ÈúÄË¶ÅÂú® setup_cm_final() ÈáåÂª∫Á´ãÈ°µË°®ÈúÄË¶ÅÁî®Âà∞Âï•ÁöÑÁâ©ÁêÜÂú∞ÂùÄÔºå‰∏ÄÊó¶Áî®ÂÆåÔºåÁ≠âÂÄºÊò†Â∞ÑÂ∞±ÂèØ‰ª•ÂÖ≥Êéâ‰∫Ü„ÄÇ
</span><span id="__span-8-195"><a id="__codelineno-8-195" name="__codelineno-8-195" href="#__codelineno-8-195"></a>- call relocate: ÂºÄÂêØsatp (supervisor address translation and protection register)
</span><span id="__span-8-196"><a id="__codelineno-8-196" name="__codelineno-8-196" href="#__codelineno-8-196"></a>- call mm_init: empty physical memory
</span><span id="__span-8-197"><a id="__codelineno-8-197" name="__codelineno-8-197" href="#__codelineno-8-197"></a>- call setup_vm_final: Âª∫Á´ãÈ°µË°® Âª∫ÂÆåÂêéÂ∞±ÂèØ‰ª•ÂÖ≥ÊéâÁ≠âÂÄºÊò†Â∞Ñ‰∫Ü
</span><span id="__span-8-198"><a id="__codelineno-8-198" name="__codelineno-8-198" href="#__codelineno-8-198"></a>- call task_init: ÂÅöÁ∫øÁ®ã
</span><span id="__span-8-199"><a id="__codelineno-8-199" name="__codelineno-8-199" href="#__codelineno-8-199"></a>
</span><span id="__span-8-200"><a id="__codelineno-8-200" name="__codelineno-8-200" href="#__codelineno-8-200"></a>### virtual memory
</span><span id="__span-8-201"><a id="__codelineno-8-201" name="__codelineno-8-201" href="#__codelineno-8-201"></a>
</span><span id="__span-8-202"><a id="__codelineno-8-202" name="__codelineno-8-202" href="#__codelineno-8-202"></a>lab2‰∏≠Êàë‰ª¨ÂÅöÁöÑÈÉΩÊòØÂÜÖÊ†∏Á∫øÁ®ãÔºåÂèØ‰ª•ÂÖ±‰∫´ËøêË°åÁ©∫Èó¥ÔºåÂç≥ËøêË°å‰∏çÂêåÁ∫øÁ®ãÂØπÂÜÖËÆ≠ÁöÑ‰øÆÊîπÊòØÁõ∏‰∫íÂèØËßÅÁöÑ„ÄÇÂ¶ÇÊûúÈúÄË¶ÅÁ∫øÁ®ãÁõ∏‰∫íÈöîÁ¶ªÂ∞±ÈúÄË¶ÅÂºïÂÖ•ËôöÊãüÂÜÖÂ≠òÔºåÊñπ‰æøÂ§öÁ∫øÁ®ãÈ´òÊïàÂÖ±‰∫´ÂÜÖÂ≠ò„ÄÇÂ¶ÇÊûúÂæàËôöÂú∞ÂéªËÆ≤ËôöÊãüÂÜÖÂ≠òÁöÑ‰ΩúÁî®Ôºö
</span><span id="__span-8-203"><a id="__codelineno-8-203" name="__codelineno-8-203" href="#__codelineno-8-203"></a>
</span><span id="__span-8-204"><a id="__codelineno-8-204" name="__codelineno-8-204" href="#__codelineno-8-204"></a>- ËôöÊãüÂÜÖÂ≠òÂèØ‰ª•‰∏∫Ê≠£Âú®ËøêË°åÁöÑÁ∫øÁ®ãÊèê‰æõÁã¨Á´ãÁöÑÂÜÖÂ≠òÁ©∫Èó¥ÔºåÂà∂ÈÄ†‰∏ÄÁßçÊØè‰∏™ËøõÁ®ãÁöÑÂÜÖÂ≠òÈÉΩÊòØÁã¨Á´ãÁöÑÂÅáË±°ÔºàÂíãÂÅöÂà∞ÁöÑÔºâ„ÄÇ
</span><span id="__span-8-205"><a id="__codelineno-8-205" name="__codelineno-8-205" href="#__codelineno-8-205"></a>- ËôöÊãüÂÜÖÂ≠òÂà∞Áâ©ÁêÜÂÜÖÂ≠òÁöÑÊò†Â∞Ñ‰πüÂåÖÂê´‰∫ÜÂØπÂÜÖÂ≠òÁöÑËÆøÈóÆÊùÉÈôêÔºåÊñπ‰æøÂÜÖÊ†∏ÂÆåÊàêÊùÉÈôêÊ£ÄÊü•
</span><span id="__span-8-206"><a id="__codelineno-8-206" name="__codelineno-8-206" href="#__codelineno-8-206"></a>
</span><span id="__span-8-207"><a id="__codelineno-8-207" name="__codelineno-8-207" href="#__codelineno-8-207"></a>
</span><span id="__span-8-208"><a id="__codelineno-8-208" name="__codelineno-8-208" href="#__codelineno-8-208"></a>Êàë‰ª¨Ë¶ÅÂÆûÁé∞ÁöÑËôöÊãüÂÜÖÂ≠òÂ∏ÉÂ±ÄÔºåÈ¶ñÂÖàÁî®‰∏Ä‰∏™Êà™ÂõæÊù•ÁêÜËß£Ôºö
</span><span id="__span-8-209"><a id="__codelineno-8-209" name="__codelineno-8-209" href="#__codelineno-8-209"></a>
</span><span id="__span-8-210"><a id="__codelineno-8-210" name="__codelineno-8-210" href="#__codelineno-8-210"></a>```plain text
</span><span id="__span-8-211"><a id="__codelineno-8-211" name="__codelineno-8-211" href="#__codelineno-8-211"></a>‰ΩéÂú∞ÂùÄ&lt;-                                       -&gt;È´òÂú∞ÂùÄ
</span><span id="__span-8-212"><a id="__codelineno-8-212" name="__codelineno-8-212" href="#__codelineno-8-212"></a>
</span><span id="__span-8-213"><a id="__codelineno-8-213" name="__codelineno-8-213" href="#__codelineno-8-213"></a>start_address             end_address
</span><span id="__span-8-214"><a id="__codelineno-8-214" name="__codelineno-8-214" href="#__codelineno-8-214"></a>    0x0                  0x3fffffffff
</span><span id="__span-8-215"><a id="__codelineno-8-215" name="__codelineno-8-215" href="#__codelineno-8-215"></a>     ‚îÇ                        ‚îÇ
</span><span id="__span-8-216"><a id="__codelineno-8-216" name="__codelineno-8-216" href="#__codelineno-8-216"></a>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îò                  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-8-217"><a id="__codelineno-8-217" name="__codelineno-8-217" href="#__codelineno-8-217"></a>‚Üì        256G           ‚Üì                                
</span><span id="__span-8-218"><a id="__codelineno-8-218" name="__codelineno-8-218" href="#__codelineno-8-218"></a>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-8-219"><a id="__codelineno-8-219" name="__codelineno-8-219" href="#__codelineno-8-219"></a>‚îÇ      User Space       ‚îÇ    ...   ‚îÇ  Kernel Space  ‚îÇ
</span><span id="__span-8-220"><a id="__codelineno-8-220" name="__codelineno-8-220" href="#__codelineno-8-220"></a>‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-8-221"><a id="__codelineno-8-221" name="__codelineno-8-221" href="#__codelineno-8-221"></a>                                   ‚Üë      256G      ‚Üë
</span><span id="__span-8-222"><a id="__codelineno-8-222" name="__codelineno-8-222" href="#__codelineno-8-222"></a>                      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                ‚îÇ 
</span><span id="__span-8-223"><a id="__codelineno-8-223" name="__codelineno-8-223" href="#__codelineno-8-223"></a>                      ‚îÇ                             ‚îÇ
</span><span id="__span-8-224"><a id="__codelineno-8-224" name="__codelineno-8-224" href="#__codelineno-8-224"></a>              0xffffffc000000000           0xffffffffffffffff
</span><span id="__span-8-225"><a id="__codelineno-8-225" name="__codelineno-8-225" href="#__codelineno-8-225"></a>                start_address                  end_address
</span></code></pre></div>
<p>ÁÑ∂ÂêéÂøÖÈ°ªË¶ÅÊêûÊòéÁôΩÔºöËôöÊãüÂÜÖÂ≠ò‰ªéÊù•Ê≤°ÊúâË¢´ÁúüÊ≠£ÂºÄËæüËøáÔºåË¢´ÁúüÊ≠£ÂºÄËæüÁöÑÂè™ÊúâÁâ©ÁêÜÂÜÖÂ≠ò„ÄÇÊàë‰ª¨Âú®Á®ãÂ∫èÂÆûÁé∞ËøáÁ®ã‰∏≠ÂºÄÁöÑÂèòÈáèÂíå alloc ÁöÑ pageÔºåÈÉΩÊòØÂºÄÂú® kernel ÁöÑÊ†àÊàñËÄÖÂ†Ü‰∏äÔºà.dataÂíå.bssÊÆµÔºâÔºåÂõ†‰∏∫Êü•Âú∞ÂùÄÊó∂ÂèØ‰ª•Êü•Âà∞ÂÆÉ‰ª¨ÁöÑÁâ©ÁêÜÂú∞ÂùÄ„ÄÇËÄåÂêÑÁßç csr Âú® cpu ÈáåÔºå‰∏ç‰ºöÂä†ËΩΩÂà∞ÂÜÖÂ≠ò‰∏≠„ÄÇËÄåÊú¨Ê¨°ÂÆûÈ™åÊâÄËÆ≤ÁöÑ‚ÄúÂºÄÂêØËôöÊãüÂÜÖÂ≠ò‚ÄùÔºåÊú¨Ë¥®‰∏äÂè™ÊòØËÆæËÆ°‰∏Ä‰∏™ËôöÊãüÂú∞ÂùÄÂà∞Áâ©ÁêÜÂú∞ÂùÄÁöÑËΩ¨Êç¢ÂáΩÊï∞ÔºåËøô‰∏™ÂáΩÊï∞ÊîæÂú®È°µË°®Èáå„ÄÇ</p>
<h3 id="sv39">Sv39 ÁöÑÈ°µË°®È°π</h3>
<p>TODO: pte ÁöÑÁªìÊûÑ ‰∏Ä‰∏™Êà™Âõæ</p>
<p>ÁêÜËß£‰∏Ä‰∏ãÈ°µË°®È°πÔºàpteÔºâ„ÄÇÂÆÉÁöÑ‰Ωé‰ΩçÔºö</p>
<ul>
<li>V: valid</li>
<li>R: readable</li>
<li>W: writable</li>
<li>X: executable</li>
<li>U: user</li>
<li>G: global Ê≤°Áî®Ëøá ÈªòËÆ§ÁΩÆ0</li>
<li>A: accessed Ê≤°Áî®Ëøá ÈªòËÆ§ÁΩÆ0</li>
<li>D: dirty Ê≤°Áî®Ëøá ÈªòËÆ§ÁΩÆ0</li>
<li>RSW: reserved ÈªòËÆ§ÁΩÆ0</li>
</ul>
<h3 id="_6">Âú∞ÂùÄÁøªËØëËøáÁ®ã</h3>
<p><code>create_mapping()</code> ÂáΩÊï∞ÈÅçÂéÜÊï¥‰∏™Êò†Â∞ÑÂ§ßÂ∞èÔºå‰æùÊ¨°Êåâ‰∫åÁ∫ßÈ°µË°®ÔºàÂç≥Ê†πÈ°µË°®ÁöÑ‰∏ã‰∏ÄÁ∫ßÔºâ‚Üí‰∏âÁ∫ßÈ°µË°®‚ÜíÁâ©ÁêÜÈ°µÔºåÊ£ÄÊü•È°µË°®È°πÁöÑV bitÁúãÈ°µË°®È°πÊòØÂê¶Â≠òÂú®Ôºå‰∏çÂ≠òÂú®ÂàôÁî®kalloc() ÂàÜÈÖç‰∏ÄÈ°µ‰Ωú‰∏∫È°µË°®ÁõÆÂΩïÔºõÂ≠òÂú®ÂàôÂú®È°µË°®È°π‰∏≠ËÆ∞ÂΩïÈ°µË°®ÁöÑÁâ©ÁêÜÂú∞ÂùÄ„ÄÇ</p>
<p>pte : [ PPN2: 53-28 ][ PPN1: 27-19 ][ PPN0: 18-10 ][ perm: 9-0 ]</p>
<p>vm_addr: [ VPN2: 38-30 ][ VPN1: 29-21 ][ VPN0:20-12 ][ offset: 11-0 ]</p>
<p>Âõ†‰∏∫Êü•ËØ¢‰∏âÁ∫ßÈ°µË°®ÁöÑÊµÅÁ®ã‰∏∫Ôºö</p>
<ul>
<li>ÂèñVPN2‰∏∫È°∂Á∫ßÈ°µË°®ÂÅèÁßªÂú∞ÂùÄÔºåÊ†πÊçÆÈ°∂Â±ÇÈ°µË°®Âü∫Âú∞ÂùÄÂæóÂà∞Ê¨°Á∫ßÈ°µË°®ÁöÑËµ∑ÂßãÂú∞ÂùÄ ‚Üí</li>
<li>ÂèñVPN1‰∏∫Ê¨°Á∫ßÈ°µË°®ÂÅèÁßªÂú∞ÂùÄÔºåÊ†πÊçÆÊ¨°Á∫ßÈ°µË°®È°µÂè∑*Ê¨°Á∫ßÈ°µË°®Â§ßÂ∞èÂæóÂà∞Ëµ∑ÂßãÂú∞ÂùÄ ‚Üí</li>
<li>ÂèñVPN0‰∏∫ËôöÊãüÂÜÖÂ≠òÂÅèÁßªÂú∞ÂùÄÔºåÊ†πÊçÆËôöÊãüÂÜÖÂ≠òÈ°µÂè∑*Áâ©ÁêÜÈ°µÂ§ßÂ∞èÂæóÂà∞Áâ©ÁêÜÂÜÖÂ≠òÂú∞ÂùÄ</li>
</ul>
<p>ÊâÄ‰ª•ÂèçÊé®ËÆæÁΩÆÁöÑÊµÅÁ®ã‰∏∫Ôºö</p>
<ul>
<li>
<p>È°∂Â±ÇÈ°µË°®</p>
<ul>
<li>Âèñnow_pte‰∏∫È°∂Á∫ßÈ°µË°®Âü∫Âú∞ÂùÄÔºö <code>now_tbl = pgtbl;</code></li>
<li>‰ªéva‰∏≠ÂèñÈ°∂Á∫ßÈ°µË°®ÂÅèÁßªÔºö <code>now_vpn = VPN2(va);</code></li>
<li>ÂæóÂà∞ÂΩìÂâçvaÂú®È°∂Á∫ßÈ°µË°®‰∏≠ÁöÑÂÖ∑‰Ωì‰ΩçÁΩÆÔºö <code>now_pte = *(now_tbl + now_vpn);</code></li>
<li>Â¶ÇÊûúÂΩìÂâç‰ΩçÁΩÆ‰∏çÂ≠òÂú®È°µÔºåÂàÜÈÖç‰∏Ä‰∏™Êñ∞ÁöÑÁâ©ÁêÜÈ°µÔºåÂπ∂ËÆ°ÁÆóÊñ∞È°µÁöÑÈ°µË°®È°πÔºåÊõ¥Êñ∞Âà∞È°∂Â±ÇÈ°µË°®Èáå</li>
</ul>
</li>
<li>
<p>Ê¨°Á∫ßÈ°µË°®Áõ∏Âêå</p>
</li>
<li>Èõ∂Á∫ßÈ°µË°®Âç≥vmÔºå‰∏çÂÜçÈúÄË¶ÅÊ£ÄÊü•V‰ΩçÔºåÂÖ∂‰Ωô‰πüÁõ∏Âêå</li>
<li>ÊúÄÂêéÊØèÊ¨°Âæ™ÁéØÔºåËôöÊãüÂú∞ÂùÄÂíåÁâ©ÁêÜÂú∞ÂùÄËá™Â¢û PG_SIZEÔºà4KBÔºâÔºåÊåáÂêë‰∏ã‰∏Ä‰∏™ËôöÊãüÈ°µ/Áâ©ÁêÜÈ°µ„ÄÇ</li>
</ul>
<h3 id="heads-todo-va2pa_offset">‰∏∫‰ªÄ‰πàÂú® head.S Èáå‰∏ÄÂºÄÂßãË¶ÅÁªôÈ°µË°®È°πÂú∞ÂùÄ (TODOÂùè‰∫Ü‰∏çËÆ∞ÂæóÊòØ‰∏çÊòØÂÆÉ‰∫Ü) ÂáèÂéª‰∏Ä‰∏™ VA2PA_offset</h3>
<p>Âú® 2023 Âπ¥ÁâàÁöÑÂÆûÈ™å‰∏≠Ôºå<code>vmlinux.lds</code> ‰∏≠ËÆæÁΩÆ‰∫ÜÂ∞ÜÁºñËØëÂá∫ÁöÑÁ¨¶Âè∑Ë°®ÈÉΩÁî®ËôöÊãüÂú∞ÂùÄÊù•Ë°®Á§∫ÔºåÊñπ‰æøË∞ÉËØï„ÄÇ‰πüÂç≥Á®ãÂ∫èËøêË°åÂà∞Ê≠§Â§ÑËØªÂà∞ÁöÑÈ°µË°®È°πÂú∞ÂùÄÊòØËôöÊãüÂú∞ÂùÄ„ÄÇÊòæÁÑ∂ÔºåÂú® <code>setup_vm()</code> ‰πãÂâçÔºåËôöÊãüÂÜÖÂ≠òËøòÊ≤°ÊúâË¢´ÂºÄÂêØÔºåÊâÄ‰ª•Ë¶ÅÂáèÊéâ‰∏Ä‰∏™ÂÅèÁßªÈáè‰ΩøÂÖ∂ËÉΩËØªÂà∞È°µË°®È°πÁöÑÁâ©ÁêÜÂú∞ÂùÄ„ÄÇÂú® <code>relocate:</code> Â§ÑÁêÜÂÅèÁßª‰πãÂêéÂ∞±‰∏çÁî®ÁÆ°‰∫Ü„ÄÇ</p>
<h2 id="lab4">lab4</h2>
<h4 id="_7">Êõ¥Êñ∞ÂêéÁöÑËôöÊãüÂÜÖÂ≠òÂ∏ÉÂ±Ä</h4>
<p>Êàë‰ª¨ÂõûÂøÜ lab3 ÈáåËôöÊãüÂú∞ÂùÄÂè™Áî®‰∫ÜÈ´ò‰ΩçÔºå‰Ωé‰ΩçÊ≤°ÊúâÁî®ÔºåÂú®Êú¨ÂÆûÈ™åÊàë‰ª¨Ë¶ÅÂ∞Ü‰Ωé‰Ωç <code>0x0-0x4000000</code> ÂàÜÁªôÁî®Êà∑ËøõÁ®ã„ÄÇËÄåÁî®Êà∑ËøõÁ®ãÁöÑ‰ª£Á†ÅÂÆûÈôÖÂú®Áâ©ÁêÜÂú∞ÂùÄ‰∏äÂàÜÈÖçÂá∫Êù•ÁöÑÊüê‰∏™Âú∞Êñπ„ÄÇÊÄª‰πãÔºåË¶ÅÂÆûÁé∞‰ª•‰∏ãÁöÑÂÜÖÂ≠òÂ∏ÉÂ±ÄÔºö
```plain text
               PHY_START   new allocated memory            allocated space end                              PHY_END
                   ‚îÇ         ‚îÇ                                ‚îÇ                                                 ‚îÇ
                   ‚ñº         ‚ñº                                ‚ñº                                                 ‚ñº
       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
 PA    ‚îÇ           ‚îÇ         ‚îÇ uapp (copied from _sramdisk)   ‚îÇ                                                 ‚îÇ
       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚ñ≤                                ‚ñ≤
       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                                ‚îÇ
       ‚îÇ            (map)                                     ‚îÇ
       ‚îÇ                        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ                        ‚îÇ
       ‚îÇ                        ‚îÇ
       ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
 VA    ‚îÇ           UAPP         ‚îÇ                                                                   ‚îÇu mode stack‚îÇ
       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚ñ≤                                                                                                         ‚ñ≤
       ‚îÇ                                                                                                         ‚îÇ</p>
<p>USER_START                                                                                                USER_END
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>#### riscvÂ§ÑÁêÜÂô®ÊîØÊåÅÁöÑÊ®°Âºè
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>- Áî®Êà∑Ê®°ÂºèÔºàU-modeÔºâÔºöÊâßË°å‰ª£Á†ÅÊó†Ê≥ïÁõ¥Êé•ËÆøÈóÆÁ°¨‰ª∂ÔºåÂè™ËÉΩÈÄöËøáosÊèê‰æõÁöÑÊé•Âè£
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>- ÂÜÖÊ†∏Ê®°ÂºèÔºàS-modeÔºâÔºöÈöèÊÑèÂπ≤‰ªÄ‰πàÈÉΩË°å
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>lab3ÂàõÂª∫ÁöÑÈÉΩÊòØÂÜÖÊ†∏Á∫øÁ®ã ÂÖ¨Áî®‰∫ÜÂú∞ÂùÄÁ©∫Èó¥ÔºàÈ°µË°®swapper_pg_dirÔºâ„ÄÇË¶ÅÂºïÂÖ•Áî®Êà∑ÊÄÅËøõÁ®ãÈúÄË¶ÅÂÅöÔºö
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>- ÂÜÖÊ†∏ËøõÁ®ãÂàõÂª∫ÔºöÊØè‰∏™Áî®Êà∑ÊÄÅÁ®ãÂ∫èÂêØÂä®Êó∂ÔºåÂàõÂª∫‰∏Ä‰∏™ÂÜÖÊ†∏ÊÄÅËøõÁ®ã
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>    - ËøôÊ†∑‰øùËØÅÊØè‰∏™Â∫îÁî®Á®ãÂ∫èÁöÑËôöÊãüÂú∞ÂùÄÁ©∫Èó¥ÊòØÁßÅÊúâÁöÑÔºå‰∏Ä‰∏™Â∫îÁî®Á®ãÂ∫èÊó†Ê≥ïÊõ¥ÊîπÂ±û‰∫éÂè¶‰∏Ä‰∏™Â∫îÁî®Á®ãÂ∫èÁöÑÊï∞ÊçÆ„ÄÇÊØè‰∏™Â∫îÁî®Á®ãÂ∫èÈÉΩÊòØÁã¨Á´ãËøêË°åÁöÑÔºåÂ¶ÇÊûú‰∏Ä‰∏™Â∫îÁî®Á®ãÂ∫èÂ¥©Ê∫ÉÔºåÂÖ∂‰ªñÂ∫îÁî®Á®ãÂ∫èÂíåÊìç‰ΩúÁ≥ªÁªüÂ∞Ü‰∏ç‰ºöÂèóÂà∞ÂΩ±Âìç„ÄÇ
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>- ÊùÉÈôêËÆæÁΩÆÔºö‰ΩøÁî®Êà∑ÊÄÅÁ®ãÂ∫è‰∏çËÉΩËÆøÈóÆkernelÊÆµ„ÄÇ
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>- Á≥ªÁªüË∞ÉÁî®ËÆæÁΩÆÔºö‰ΩøÁî®Êà∑ÊÄÅÁ®ãÂ∫èÊÉ≥ËÆøÈóÆÂÖ≥ÈîÆËµÑÊ∫êÊó∂Ôºå‰ΩøÁî®Á≥ªÁªüË∞ÉÁî®‰∏éos‰∫íÂä®„ÄÇ
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>ÂÖ∑‰ΩìÂú®Êàë‰ª¨ÁöÑÂÆûÈ™åÊìç‰Ωú‰∏≠ÔºåÂÆûÁé∞Áî®Êà∑ÊÄÅÂíåÂÜÖÊ†∏ÊÄÅÂàáÊç¢ÁöÑÊñπÊ≥ïÊòØÔºösstatus[SUM] Âíå PTE[U]
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>- ÂØÑÂ≠òÂô® sstatus[SUM] 
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>    - Êú¨Êù•=0 ‚Üí s-mode Ê≤°Ê≥ïÊâßË°åÁî®Êà∑È°µÈáåÁöÑÁ®ãÂ∫è
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a>    - Ë¶ÅÊääÂÆÉÊâìÂºÄÔºà=1Ôºâ‚Üí ‰Ωøs-modeÂèØ‰ª•ÊâßË°åÁî®Êà∑È°µÈáåÁöÑÁ®ãÂ∫è
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>- È°µË°®È°π PTE[U] 
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a>    - = 0 ÂÜÖÊ†∏È°µ
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a>    - = 1 Áî®Êà∑È°µ
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a>!!! warning
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a>    ÊÉ≥ÂÜô‰∏Ä‰∏ãÂú®Ê±áÁºñ‰ª£Á†ÅÈáåÁöÑÊìç‰ΩúÔºåÂøòÂπ≤ÂáÄ‰∫ÜÔºåÊï¥‰ΩìÊÄùË∑ØÊòØËøôÊ†∑ÁöÑÔºå‰ΩÜ‰∏Ä‰∫õÁªÜËäÇÂæÖÊ†∏ÂÆû
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a>Âπ∂‰∏îÂú®Ê±áÁºñ‰ª£Á†ÅÈáåÈúÄË¶ÅÂÆûÁé∞‰∏ÄÁ≥ªÂàó csr ËØªÂÜôÊìç‰ΩúÔºö
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a>- `__switch_to`: ÈúÄË¶ÅÂä†ÂÖ•‰øùÂ≠ò/ÊÅ¢Â§ç¬†`sepc`¬†`sstatus`¬†`sscratch`¬†‰ª•ÂèäÂàáÊç¢È°µË°®ÁöÑÈÄªËæë„ÄÇÂú®ÂàáÊç¢‰∫ÜÈ°µË°®‰πãÂêéÔºåÈúÄË¶ÅÈÄöËøá¬†`fence.i`¬†Âíå¬†`vma.fence`¬†Êù•Âà∑Êñ∞ TLB Âíå ICache„ÄÇ
</span><span id="__span-9-31"><a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a>- `_traps` Âíå `trap_handler()`: Âõ†‰∏∫Êàë‰ª¨ÁöÑÁ∫øÁ®ãÊòØÂú®trapÈáåÂàáÊç¢ÁöÑÔºåËøòË¶ÅÊîπtrapÁöÑÈÄªËæë„ÄÇÁ∫øÁ®ãÂú®u-modeÈáåËøêË°åÔºåÂà∞trapË¶ÅÂàáÊàês-modeÔºå‰∏≠Êñ≠ÂÆåÂÜçÂàáÂõûÊù•„ÄÇ‰∏îÂ¶ÇÊûúÊòØÂÜÖÊ†∏Á∫øÁ®ãÔºàÊ≤°Êúâu-mode stackÔºâËß¶Âèë‰∫ÜÂºÇÂ∏∏Â∞±‰∏çÈúÄË¶ÅËøõË°åÂàáÊç¢ÔºåÊâÄ‰ª•ÂÜÖÊ†∏Á∫øÁ®ãÁöÑspÊ∞∏ËøúÊåáÂêës-mode stackÔºåsscratchÔºàspÔºüÔºâ‰∏∫0„ÄÇTODOÔºöÊúâ‰∏Ä‰∏™ÈùûÂ∏∏‰ºòÈõÖÁöÑÁõ¥Êé•ÂÆûÁé∞‰∏§‰∏™ csr ‰∫§Êç¢ÁöÑÂëΩ‰ª§„ÄÇÊâæ‰∏çÂà∞‰∫Ü„ÄÇ‰ºöË°•ÁöÑ„ÄÇ
</span><span id="__span-9-32"><a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a>- `__dummy`: Êàë‰ª¨ÂõûÂøÜ‰πãÂâç lab2 ÂÆûÁé∞ÁöÑÊòØÔºåÁõ¥Êé•Â∞Ü `__dummy` ÂáΩÊï∞ÁöÑÂÜôÂú®Á∫øÁ®ãÁöÑ sepcÔºà‰∏≠Êñ≠ËøîÂõûÂú∞ÂùÄÔºâÈáåÔºåÂèàÂú® `__dummy` ÈáåÂÜôËøîÂõûÂú∞ÂùÄÊòØ `dummy()` ÂáΩÊï∞„ÄÇÊâÄ‰ª•Â¶ÇÊûúÊàë‰ª¨ËøôÈáåÊÉ≥ËÆ©ËøõÁ®ãÂàáÊç¢Âà∞Áî®Êà∑ËøõÁ®ãÂêéËøõÂÖ•Áî®Êà∑Á®ãÂ∫èÔºå‰øÆÊîπ `__dummy` ËøêË°åÂÆåÊâÄËøîÂõûÁöÑÂú∞ÂùÄ‰∏∫ user app ÁöÑÁ¨¨‰∏ÄÊù°Êåá‰ª§Âú∞ÂùÄÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇ
</span><span id="__span-9-33"><a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a>
</span><span id="__span-9-34"><a id="__codelineno-9-34" name="__codelineno-9-34" href="#__codelineno-9-34"></a>#### buddy system
</span><span id="__span-9-35"><a id="__codelineno-9-35" name="__codelineno-9-35" href="#__codelineno-9-35"></a>
</span><span id="__span-9-36"><a id="__codelineno-9-36" name="__codelineno-9-36" href="#__codelineno-9-36"></a>‰∏ÄÁßçÁâ©ÁêÜÂÜÖÂ≠òÁÆ°ÁêÜÁÆóÊ≥ïÔºåÁ©∫Èó≤Á©∫Èó¥È¶ñÂÖàË¢´ÁúãÊàê 2^N ‰∏™Áâ©ÁêÜÈ°µÁöÑÂ§ßÁ©∫Èó¥ÔºåÂΩì‰∏Ä‰∏™Â§ßÂ∞è‰∏∫ m ÁöÑÈ°µËØ∑Ê±ÇÂÜÖÂ≠òÂàÜÈÖçÊó∂Ôºå‰∏çÂÅúÊääÁ©∫Èó¥ /2 ÂàíÂàÜÔºåÊúÄÂêéÊâæÂà∞ÊúÄÊé•ËøëmÁöÑ2ÁöÑÊ¨°ÊñπÁöÑ‰∏Ä‰∏™Á©∫Èó¥Â§ßÂ∞èÂàÜÁªô m„ÄÇÂΩìÂùóÈáäÊîæÊó∂ÔºåÂàÜÈÖçÂô®Â∞±‰ºöÊâæÂà∞ÂÖ∂ÂÆÉÁ©∫Èó≤ÁöÑ‰ºô‰º¥ÂùóÂéªÂêàÂπ∂„ÄÇÂÆÉÁöÑÂÆûÁé∞Âú®Ëøô‰∏™ÊñáÁ´†ÈáåËÆ≤ÂæóÊõ¥Â•Ω [Lab 6ÔºöRISC-V Âä®ÊÄÅÂÜÖÂ≠òÂàÜÈÖç‰∏éÁº∫È°µÂºÇÂ∏∏Â§ÑÁêÜ - Áü•‰πé (zhihu.com)](https://zhuanlan.zhihu.com/p/456803049)„ÄÇ
</span><span id="__span-9-37"><a id="__codelineno-9-37" name="__codelineno-9-37" href="#__codelineno-9-37"></a>
</span><span id="__span-9-38"><a id="__codelineno-9-38" name="__codelineno-9-38" href="#__codelineno-9-38"></a>#### elf Êñá‰ª∂
</span><span id="__span-9-39"><a id="__codelineno-9-39" name="__codelineno-9-39" href="#__codelineno-9-39"></a>
</span><span id="__span-9-40"><a id="__codelineno-9-40" name="__codelineno-9-40" href="#__codelineno-9-40"></a>‰∏Ä‰∏™ elf Êñá‰ª∂ÂÉè‰∏Ä‰∏™Â∞ÅË£ÖÂ§çÊùÇÁâàÁöÑ‰∫åËøõÂà∂Áî®Êà∑Á®ãÂ∫è„ÄÇÁî®ÊäΩË±°ÁöÑÁîªÂõæÁªôÂÆÉÁöÑÁªìÊûÑÂÅö‰∏Ä‰∏™ÊØîÂñªÔºàÂØπ‰∏çËµ∑Â§™ÊäΩË±°‰∫ÜÔºâÔºö
</span><span id="__span-9-41"><a id="__codelineno-9-41" name="__codelineno-9-41" href="#__codelineno-9-41"></a>
</span><span id="__span-9-42"><a id="__codelineno-9-42" name="__codelineno-9-42" href="#__codelineno-9-42"></a>```plain text
</span><span id="__span-9-43"><a id="__codelineno-9-43" name="__codelineno-9-43" href="#__codelineno-9-43"></a>Elf_Ehdr     ehdr-&gt;e_phoff
</span><span id="__span-9-44"><a id="__codelineno-9-44" name="__codelineno-9-44" href="#__codelineno-9-44"></a>‚¨áÔ∏è            ‚¨áÔ∏è
</span><span id="__span-9-45"><a id="__codelineno-9-45" name="__codelineno-9-45" href="#__codelineno-9-45"></a>[            [type: ???][type: LOAD][type: ???] ]
</span></code></pre></div>
Â∞±ÊòØ elf Êñá‰ª∂ÈáåÊï£ËêΩÁùÄÂá†‰∏™Â∞èÊÆµÔºåÂÖ∂‰∏≠‰∏Ä‰∏™Á±ªÂûã‰∏∫ LOAD ÁöÑÊÆµÊòØÈúÄË¶ÅÂ§çÂà∂Âà∞Á∫øÁ®ã‰ª£Á†ÅÊÆµÁöÑÔºå‰ΩÜ‰∏ç‰∏ÄÂÆöÂ§çÂà∂Âà∞Á∫øÁ®ãÂ§¥ÁöÑËµ∑ÂßãÂú∞ÂùÄ <code>0x0</code>Ôºå<code>p_vaddr</code> ‰ºöÂëäËØâ‰Ω†ËøôÊÆµ‰ª£Á†ÅÂ∏åÊúõË¢´Â§çÂà∂Âà∞Âì™ÈáåÂéª„ÄÇe_entry ‰πüË¥¥ÂøÉÂëäËØâ‰Ω†Á¨¨‰∏ÄÊù°‰ª£Á†ÅÊåá‰ª§ÁöÑËµ∑ÂßãÂú∞ÂùÄÂú®Âì™„ÄÇÊÄª‰πãÔºå‰Ω†ÈúÄË¶ÅÂÖàÈÄöËøá‰∏Ä‰∫õÂÅèÁßªÈáèÂú® Elf64_Ehdr Ëøô‰∏™ÊåáÈíàÈáåÊâæÂà∞Á¨¨‰∏Ä‰∏™ segmentÔºåÁÑ∂Âêé‰ª•‰∏Ä‰∏™ Elf63_phdr ÁöÑÂ§ßÂ∞è‰∏∫Âçï‰ΩçÔºåÊå®‰∏™ÂéªÂØªÊâæ‰∏Ä‰∏™Á±ªÂûã‰∏∫ LOAD ÁöÑ segment„ÄÇÁ≠âÊâæÂà∞‰∫ÜÂ∞±ÂèØ‰ª•Êã∑Ë¥ù‰∫Ü„ÄÇ</p>
<p>Â¶ÇÊûú‰Ω†ÊåâÁÖß‰∏ÄÂ†ÜÊåáÈíàÁöÑÂÜôÊ≥ïË¢´ÊêûÂæóÊôïÂ§¥ËΩ¨ÂêëÔºåÁîöËá≥Âè™ÊòØÂÖàÁî® <code>readelf -h</code> Êü•Áúã‰∏Ä‰∏ã elf Êñá‰ª∂ÈáåÂêÑ‰∏™‰∏úË•øÁöÑÂú∞ÂùÄÔºàÊü•ÁúãÂêéÂèØ‰ª•ÂèëÁé∞‰∏éÂÆûÈ™åÊåáÂØº‰∏≠ÁªôÁöÑ‰æãÂ≠êÂ∞±ÊòØÂêå‰∏Ä‰∏™Êñá‰ª∂ÔºâÔºåÁÑ∂ÂêéÁõ¥Êé•ÊääÊï¥‰∏™ uapp Á®ãÂ∫èÂÖ®ÈÉ®Êã∑Âà∞ËøõÁ®ãÈáåÊù•ÔºåÁõ¥Êé•Êää <code>__dummy</code> ËøîÂõûÂú∞ÂùÄÊåáÂà∞‰Ω†Âú®Êñá‰ª∂ÈáåËØªÂá∫Êù•ÁöÑÈÇ£‰∏™‰ª£Á†ÅËµ∑ÂßãÂú∞ÂùÄÔºåÁîöËá≥ÈÉΩËÉΩË∑ë„ÄÇÂú®Ë∑ëËµ∑Êù•‰πãÂêéÔºåÊ†πÊçÆ‰Ω†ÁöÑÁêÜËß£‰∏ÄÁÇπ‰∏ÄÁÇπÊääËÆæÁΩÆÊåáÈíàÁöÑ‰ª£Á†ÅÊåâÁÖßÂê´‰πâÊõøÊç¢‰∏äÔºåÊàëÊÑüËßâËøôÊ†∑ÂèçÁùÄÂÅö‰πüË°å„ÄÇ</p>
<h2 id="lab5">lab5</h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>‰∏ãÈù¢Âá†‰∏™ÂÆûÈ™åÊàëÂÜôÂæóÊúâÁÇπÁÆÄÁï•ÔºåÂ∞èÈÉ®ÂàÜÂõ†‰∏∫Êàë‰∏çËÆ∞Âæó‰∫ÜÔºåÂ§ßÈÉ®ÂàÜÂõ†‰∏∫ÊàëËá™ÊàëÊÑüËßâÊ≤°ÊúâÂêÉÈÄèËøô‰∏™ÂÆûÈ™åÔºå‰∏çÁè≠Èó®ÂºÑÊñß‰∫Ü„ÄÇ‰ΩÜÊòØËøô‰∏™Âú∞ÊñπÂèëËá™ÂÜÖÂøÉÂú∞ÊÉ≥Áïô‰∏™ TODO Â∏åÊúõËÉΩÊúâÊú∫‰ºöË°•ÂÆå„ÄÇ</p>
</div>
<p>Êú¨ÂÆûÈ™å‰∏é lab4 ÂÜÖÂ≠òÂàÜÈÖçÁöÑÂå∫Âà´ÊòØÔºå‰∏∫‰∫ÜÈò≤Ê≠¢Áâ©ÁêÜÂÜÖÂ≠ò‰∏çË∂≥ÔºåÂú® task ÂàùÂßãÂåñËØ∑Ê±ÇÁ©∫Èó¥Êó∂ÔºåÂÖà‰∏çÂàÜÈÖçÁâ©ÁêÜÂÜÖÂ≠òÔºåËÄåÊòØÁî® <code>do_mmap()</code> ÂÖàÊää task ÁöÑËØ∑Ê±ÇÁöÑÊâÄÊúâÂèÇÊï∞ËÆ∞ÂΩï‰∏ãÊù•ÔºåÁ≠â task ÁúüÊ≠£ÂéªËÆøÈóÆÁöÑÊó∂ÂÄôÔºåÂøÖÁÑ∂‰ºöËß¶Âèë page faultÔºåÁÑ∂ÂêéÂú® page fault handler ÈáåÊ†πÊçÆËÆ∞ÂΩïÁöÑÂèÇÊï∞ÔºåÂÜçÂàÜÈÖçÁâ©ÁêÜÂÜÖÂ≠ò„ÄÇ</p>
<h2 id="lab6">lab6</h2>
<p>ÂÆûÈ™å‰∏ªË¶ÅÁõÆÊ†áÊòØÂÆûÁé∞ÂàõÂª∫Â≠êËøõÁ®ãÁöÑÈÄªËæëÔºåÂç≥Âú®Áî®Êà∑Á®ãÂ∫èË∞ÉÁî®fork()ÂáΩÊï∞Ôºå‰∫ßÁîü220Âè∑Á≥ªÁªüË∞ÉÁî®ÁöÑÊó∂ÂÄôÔºåÂú®sys_clone()Ëøô‰∏™ÂáΩÊï∞ÈáåÂàõÂª∫Â≠êËøõÁ®ãÔºåÂπ∂‰ΩøÂÖ∂Âä†ÂÖ•Ë¢´Ë∞ÉÁî®ÁöÑtaskÈòüÂàó„ÄÇ</p>
<h2 id="lab7">lab7</h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>lab7 ÊàëÂè™ÂÆåÊàê‰∫ÜÂç† 60% ÁöÑÁ¨¨‰∏ÄÈÉ®ÂàÜÔºå‰ΩÜÂÖ∂ÂÆûÂ∑•‰ΩúÈáèÊØîËæÉÂ§ßÁöÑËøòÂú®Á¨¨‰∫åÈÉ®ÂàÜ„ÄÇÊàëËøôÈáåÂè™ËÉΩÊÄªÁªìÁ¨¨‰∏ÄÈÉ®ÂàÜ‰∫Ü„ÄÇ</p>
</div>
<p>Êú¨ÂÆûÈ™åÊØè‰∏™taskÈÉΩÊúâ‰∏Ä‰∏™ÁªìÊûÑ‰ΩìÂéªÁª¥Êä§Â∑≤ÁªèÊâìÂºÄÁöÑÊñá‰ª∂Ë°®„ÄÇÊú¨ÂÆûÈ™åÈ¶ñÂÖà‰øÆÊîπtask structÔºåÂú®ÊØè‰∏™task struct‰∏≠Ê∑ªÂä†‰∫Ü‰∏Ä‰∏™È°µ(struct file* Âûã)ÂéªÁª¥Êä§Ëøô‰∏™Êñá‰ª∂Ë°®„ÄÇ</p>
<p>ÊØè‰∏™Êñá‰ª∂Ë°®Êúâ‰∏Ä‰∫õÂáΩÊï∞ÊåáÈíàÔºåÂàÜÂà´ÊåáÂêëÂØπÊñá‰ª∂ÁöÑËØªÂÜôÊìç‰ΩúÂáΩÊï∞„ÄÇÈ¶ñÂÖàÈúÄË¶ÅÂÆûÁé∞Ëøô‰∫õÂáΩÊï∞ÔºåÂ¶Ç <code>stdout_write()</code> Âíå <code>stdin_read()</code> Á≠â„ÄÇ</p>
<p>ÂΩìÁî®Êà∑Á®ãÂ∫è‰∫ßÁîüÊñá‰ª∂ËØªÂÜôÁöÑ system call Êó∂Ôºå<code>trap_handler()</code> ‰∏≠ÈúÄË¶ÅÂÆûÁé∞ÂØπËøô‰∫õ system call ÁöÑÂ§ÑÁêÜÂáΩÊï∞„ÄÇÂÖ∑‰ΩìÊìç‰ΩúÂ∞±ÊòØÊçïËé∑ÔºåÁÑ∂Âêé‰ªÄ‰πà‰πü‰∏çÂÅöÔºåÁõ¥Êé•ÊääÂèÇÊï∞‰∫§Áªô‰∏äËø∞ÂÆûÁé∞ÁöÑÊñá‰ª∂ËØªÂÜôÂáΩÊï∞Êù•Êìç‰Ωú„ÄÇ</p>
<h2 id="_8">Â∏∏ËßÅÈóÆÈ¢ò‰πãË°•ÂÖÖÂèàÂêçÊàë‰πãÊÄªÊòØÈÅáËßÅÈóÆÈ¢ò</h2>
<p><strong>Q1</strong>: ËøêË°åÂèëÁé∞Á®ãÂ∫èÂú®Âá†‰∏™ÂàùÂßãÂåñÂáΩÊï∞‰πãÈó¥Êù•ÂõûË∑≥Ë∑ÉÔºåÊØîÂ¶ÇÂ∑≤ÁªèÂà∞‰∫Ü <code>set_up_vm_final()</code>ÔºåÂèàË∑≥Âõû <code>set_up_vm()</code>ÔºåÂÜçÂæÄ‰∏ãËøêË°åÂ∞±Âú®ËøôÂá†‰∏™ÂáΩÊï∞‰πãÈó¥Âæ™ÁéØ„ÄÇËøõÂÖ• gdb Ë∞ÉËØïÔºåÂàôÂèëÁé∞ÂèëÁîüË∑≥ËΩ¨ÁöÑÂú∞ÊñπÂπ∂Ê≤°Êúâ‰ªª‰Ωï branch ÊàñËÄÖ call ËØ≠Âè•ÊåáÂêëË∑≥ÂæÄÁöÑÂú∞ÂùÄÔºå‰ΩÜÊòØËÉΩËßÇÂØüÂà∞Âá∫Áé∞Ë∑≥ËΩ¨ÁöÑÂú∞ÊñπÔºåÂæÄÂæÄÊòØËøõ‰∫Ü memset() ÊàñËÄÖ memcopy() ÂáΩÊï∞„ÄÇ</p>
<p><strong>A1</strong>: Êï¥‰∏™ÂÆûÈ™åËøáÁ®ã‰∏≠ÊàëÈÅáÂà∞‰∫Ü‰∏âÂõõÊ¨°Ôºå‰∏ÄÂºÄÂßãËßâÂæóÊòØ‰ª•Â•áÊÄ™ÁöÑÊñπÂºèËß£ÂÜ≥‰∫ÜÔºàÊØîÂ¶ÇÔºåÁ™ÅÁÑ∂ÂèëÁé∞Ëá™Â∑±Âú®ÂàùÂßãÂåñËøõÁ®ãÔºåÂºïÂÖ•Â§ñÈÉ®È°µË°®Êó∂Áî®Âà∞ÁöÑ‰ª£Á†ÅÊòØ <code>extern unsigned long *swapper_pg_dir;</code>ÔºåËÄå‰∏çÊòØ <code>extern unsigned long swapper_pg_dir[512] __attribute__((__aligned__(0x1000)));</code>ÔºåÂç≥ÔºåÁº∫Â∞ë‰∫Ü‰∏Ä‰∏™Âú∞ÂùÄÂØπÈΩê„ÄÇÂêåÂ≠¶ÊåáÂá∫Â¶ÇÊûúÊ≤°ÊúâÂØπÈΩêÔºåÂèØËÉΩ‰ºöÂØºËá¥È°µË°®ËæπÁºòÁöÑ‰∏Ä‰∫õÊï∞ÊçÆÁöÑ‰∏¢Â§±ÊçüÂùè„ÄÇÔºâÔºåÂêéÊù•ÊÖ¢ÊÖ¢ÂèëÁé∞ËßÑÂæãÊòØÔºöÂèëÁîüËøôÊ†∑Ë∑≥ËΩ¨ÁöÑÊåá‰ª§ÔºåÈÉΩÂú®Â∞ùËØïÂæÄ <code>0x80000000</code> Ëøô‰∏™Áâ©ÁêÜÂú∞ÂùÄ‰ª•‰∏ãÁöÑÁâ©ÁêÜÂú∞ÂùÄÂÜô‰∏úË•ø„ÄÇÊàë‰ª¨Ê≥®ÊÑèÂà∞ qemu Êèê‰æõÁªôÊàë‰ª¨ÁöÑÁâ©ÁêÜÂú∞ÂùÄÈÉΩÊòØ <code>0x80000000</code> ‰ª•‰∏äÁöÑÂú∞ÂùÄÔºåËôΩÁÑ∂Ê≤°ÊúâËÄÉËØÅÔºå‰ΩÜÊòØÂêàÁêÜÁåúÊµãÂÖ∂‰∏ãÁöÑÂú∞ÂùÄÊòØ qemu Ëá™Â∑±ÁöÑ‰ª£Á†ÅÂå∫ÔºåÊîØÊåÅ qemu Ëá™Â∑±ÁöÑËøêË°åÈÄªËæë„ÄÇÂ¶ÇÊûú‰∏çÂ∞èÂøÉÂÜôÂà∞‰∫ÜËøô‰∏™Âú∞ÊñπÔºåÂΩìÁÑ∂ÂèØËÉΩÂèëÁîü‰∏çËÉΩËß£ÈáäÁöÑ qemu Ë°å‰∏∫„ÄÇ</p>
<p>ÊâÄ‰ª•Â¶ÇÊûúÈÅáÂà∞Ëøô‰∏™ÈóÆÈ¢òÔºåÂèØË°åÁöÑ‰∏ÄÊ≠•‰∏ÄÊ≠•Ê£ÄÊü•ÊñπÊ≥ïÊòØÔºö</p>
<ul>
<li>Ê£ÄÊü• lab3 <code>create_mapping()</code> ÂÅöÈ°µË°®ÊúâÊ≤°ÊúâÂÅöÂØπ„ÄÇ‰∏Ä‰∏™ÊºÇ‰∫ÆÁöÑÊ£ÄÊü•ÊñπÊ≥ïÊòØ <code>printk("[function name]: map from %#llx-%#llx to %#llx-%#llx", pa, pa+size, va, va+size);</code>ÔºåÂ∏ÆÂä©Ê£ÄÊü•‰ªéÂì™‰∏™Âú∞ÂùÄ copy Âà∞Âì™‰∏™Âú∞ÂùÄ‰∫Ü„ÄÇ</li>
<li>Ê£ÄÊü•ÂÅöÂ•ΩÁöÑÈ°µË°®Ôºå‰ΩøÁî®‰∏äÊòØÂê¶Ê≠£Á°Æ„ÄÇ</li>
<li>Ê£ÄÊü• <code>memset()</code> <code>memcpy()</code> Á≠âÂáΩÊï∞ÊúâÊ≤°ÊúâÁî®ÂØπ„ÄÇ‰∏ÄÊ†∑ÊòØÁî®‰∏äÈù¢Á±ª‰ººÁöÑ prink ÂéªÊâìÂç∞Ëµ∑ÂßãÂú∞ÂùÄ„ÄÇ</li>
</ul>
<p>ÊÄª‰πãÔºåÊ†πÊú¨ÁõÆÊ†áÊòØÂéªÁúã‰∏Ä‰∏ãÊúâÊ≤°ÊúâÂæÄÁâ©ÁêÜÂú∞ÂùÄ <code>0x80000000</code> ‰ª•‰∏ãÁöÑÂú∞ÊñπÂÜô‰∏úË•ø„ÄÇ</p>
<p><strong>Q2</strong>: ËøêË°åÁ®ãÂ∫èÂà∞‰∏ÄÂçäÂç°‰ΩèÔºåÊ≤°Êúâ‰ªª‰ΩïËæìÂá∫‰∫ÜÔºåË∞ÉËØïÂèëÁé∞ÊúÄÂêéÊòØÂú® <code>__dummy</code> ÁöÑ <code>sret</code> ÂêéÂç°‰Ωè‰∫Ü„ÄÇ</p>
<p><strong>A2</strong>: ÂèØ‰ª•ÂÖàÂÆûÁé∞‰∏Ä‰∏™ÊºÇ‰∫ÆÁÇπÁöÑ <code>trap_handler()</code> Â∏ÆÂä©Ë∞ÉËØï„ÄÇËøôÁÇπÂú® lab7 ÁöÑÊåáÂØºÈáåÊâçÊúâÊèêÁ§∫Âà∞Ôºå‰∏çËøáÊàëËßâÂæóÂ∫îËØ•Êó©ÁÇπÂÆûÁé∞Ëµ∑Êù•„ÄÇÊØîÂ¶ÇÔºö</p>
<p><div class="language-c highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">trap_handler</span><span class="p">(</span><span class="n">uint64</span><span class="w"> </span><span class="n">scause</span><span class="p">,</span><span class="w"> </span><span class="n">uint64</span><span class="w"> </span><span class="n">sepc</span><span class="p">,</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">pt_regs</span><span class="o">*</span><span class="w"> </span><span class="n">regs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// a0, a1, a2</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">    </span><span class="n">uint64</span><span class="w"> </span><span class="n">stval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">csr_read</span><span class="p">(</span><span class="n">stval</span><span class="p">);</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">    </span><span class="c1">// printk(&quot;[S] Trap @sepc = %#llx, @scause = %#llx, @stval = %#llx\n&quot;, sepc, scause, stval);</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">    </span><span class="cm">/* Interrupt */</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">scause</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">63</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">scause</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x7FFFFFFFFFFFFFFF</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="w">        </span><span class="n">clock_set_next_event</span><span class="p">();</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">        </span><span class="n">printk</span><span class="p">(</span><span class="s">&quot;[S] Supervisor Timer Intterupt</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">        </span><span class="n">do_timer</span><span class="p">();</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="w">    </span><span class="cm">/* Exception */</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="w">        </span><span class="cm">/* instrution addr misaligned */</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">scause</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="w">        </span><span class="cm">/* Instruction access fault */</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">scause</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="w">        </span><span class="cm">/* Illegal instruction */</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">scause</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="w">        </span><span class="cm">/* breakpoint */</span>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">scause</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a><span class="w">        </span><span class="cm">/* load addr misaligned */</span>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">scause</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="w">        </span><span class="cm">/* load access fault */</span>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">scause</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a><span class="w">        </span><span class="cm">/* store/amo addr misaligned */</span>
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">scause</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a><span class="w">        </span><span class="cm">/* store/amo access fault */</span>
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">scause</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a><span class="w">        </span><span class="cm">/* ecall U-mode */</span>
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">scause</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a><span class="w">            </span><span class="n">uint64</span><span class="w"> </span><span class="n">sys_call_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">regs</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span>
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sys_call_num</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">SYS_WRITE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-36"><a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a><span class="w">                </span><span class="n">regs</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sys_write</span><span class="p">(</span><span class="n">regs</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span><span class="w"> </span><span class="n">regs</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span><span class="w"> </span><span class="n">regs</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">[</span><span class="mi">12</span><span class="p">]);</span>
</span><span id="__span-10-37"><a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span>
</span><span id="__span-10-38"><a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sys_call_num</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">SYS_GETPID</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-39"><a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a><span class="w">                </span><span class="n">regs</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sys_getpid</span><span class="p">();</span>
</span><span id="__span-10-40"><a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span>
</span><span id="__span-10-41"><a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sys_call_num</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">SYS_CLONE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-42"><a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a><span class="w">                </span><span class="c1">// initialize currents&#39; pt_regs</span>
</span><span id="__span-10-43"><a id="__codelineno-10-43" name="__codelineno-10-43" href="#__codelineno-10-43"></a><span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">32</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-44"><a id="__codelineno-10-44" name="__codelineno-10-44" href="#__codelineno-10-44"></a><span class="w">                    </span><span class="n">current</span><span class="o">-&gt;</span><span class="n">regsframe</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">regs</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span><span id="__span-10-45"><a id="__codelineno-10-45" name="__codelineno-10-45" href="#__codelineno-10-45"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-10-46"><a id="__codelineno-10-46" name="__codelineno-10-46" href="#__codelineno-10-46"></a><span class="w">                </span><span class="n">current</span><span class="o">-&gt;</span><span class="n">regsframe</span><span class="o">-&gt;</span><span class="n">sepc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">regs</span><span class="o">-&gt;</span><span class="n">sepc</span><span class="p">;</span>
</span><span id="__span-10-47"><a id="__codelineno-10-47" name="__codelineno-10-47" href="#__codelineno-10-47"></a><span class="w">                </span><span class="n">regs</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sys_clone</span><span class="p">(</span><span class="n">regs</span><span class="p">);</span>
</span><span id="__span-10-48"><a id="__codelineno-10-48" name="__codelineno-10-48" href="#__codelineno-10-48"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-10-49"><a id="__codelineno-10-49" name="__codelineno-10-49" href="#__codelineno-10-49"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-50"><a id="__codelineno-10-50" name="__codelineno-10-50" href="#__codelineno-10-50"></a><span class="w">                </span><span class="n">printk</span><span class="p">(</span><span class="s">&quot;[S] Unhandled syscall with sys_call_num = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sys_call_num</span><span class="p">);</span>
</span><span id="__span-10-51"><a id="__codelineno-10-51" name="__codelineno-10-51" href="#__codelineno-10-51"></a><span class="w">                </span><span class="n">current</span><span class="o">-&gt;</span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-10-52"><a id="__codelineno-10-52" name="__codelineno-10-52" href="#__codelineno-10-52"></a><span class="w">                </span><span class="n">schedule</span><span class="p">();</span>
</span><span id="__span-10-53"><a id="__codelineno-10-53" name="__codelineno-10-53" href="#__codelineno-10-53"></a><span class="w">                </span><span class="c1">// while (1);</span>
</span><span id="__span-10-54"><a id="__codelineno-10-54" name="__codelineno-10-54" href="#__codelineno-10-54"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-10-55"><a id="__codelineno-10-55" name="__codelineno-10-55" href="#__codelineno-10-55"></a><span class="w">            </span><span class="n">regs</span><span class="o">-&gt;</span><span class="n">sepc</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="c1">// pc + 4</span>
</span><span id="__span-10-56"><a id="__codelineno-10-56" name="__codelineno-10-56" href="#__codelineno-10-56"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span>
</span><span id="__span-10-57"><a id="__codelineno-10-57" name="__codelineno-10-57" href="#__codelineno-10-57"></a><span class="w">        </span><span class="cm">/* ecall S-mode */</span>
</span><span id="__span-10-58"><a id="__codelineno-10-58" name="__codelineno-10-58" href="#__codelineno-10-58"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">scause</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
</span><span id="__span-10-59"><a id="__codelineno-10-59" name="__codelineno-10-59" href="#__codelineno-10-59"></a><span class="w">        </span><span class="cm">/* Instruction page fault */</span>
</span><span id="__span-10-60"><a id="__codelineno-10-60" name="__codelineno-10-60" href="#__codelineno-10-60"></a><span class="w">        </span><span class="cm">/* Load page fault */</span>
</span><span id="__span-10-61"><a id="__codelineno-10-61" name="__codelineno-10-61" href="#__codelineno-10-61"></a><span class="w">        </span><span class="cm">/* Store/amo page fault */</span>
</span><span id="__span-10-62"><a id="__codelineno-10-62" name="__codelineno-10-62" href="#__codelineno-10-62"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">scause</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">scause</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">13</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">scause</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-63"><a id="__codelineno-10-63" name="__codelineno-10-63" href="#__codelineno-10-63"></a><span class="w">            </span><span class="n">done</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">do_page_fault</span><span class="p">(</span><span class="n">scause</span><span class="p">,</span><span class="w"> </span><span class="n">regs</span><span class="p">);</span>
</span><span id="__span-10-64"><a id="__codelineno-10-64" name="__codelineno-10-64" href="#__codelineno-10-64"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span>
</span><span id="__span-10-65"><a id="__codelineno-10-65" name="__codelineno-10-65" href="#__codelineno-10-65"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-66"><a id="__codelineno-10-66" name="__codelineno-10-66" href="#__codelineno-10-66"></a><span class="w">            </span><span class="n">printk</span><span class="p">(</span><span class="s">&quot;[S] Unhandled exception with scause = %d, sepc = %lx</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">scause</span><span class="p">,</span><span class="w"> </span><span class="n">sepc</span><span class="p">);</span>
</span><span id="__span-10-67"><a id="__codelineno-10-67" name="__codelineno-10-67" href="#__codelineno-10-67"></a><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-10-68"><a id="__codelineno-10-68" name="__codelineno-10-68" href="#__codelineno-10-68"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-10-69"><a id="__codelineno-10-69" name="__codelineno-10-69" href="#__codelineno-10-69"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-10-70"><a id="__codelineno-10-70" name="__codelineno-10-70" href="#__codelineno-10-70"></a><span class="w">    </span><span class="c1">// if (!done) while(1);</span>
</span><span id="__span-10-71"><a id="__codelineno-10-71" name="__codelineno-10-71" href="#__codelineno-10-71"></a><span class="p">}</span>
</span></code></pre></div>
ÊÄª‰πãÔºåÂª∫ËÆÆÂØπ <code>trap_handler()</code> ÂÅöÁöÑÊîπËøõÊúâ‰∏§‰ª∂
- Â¶ÇÊûúÂèëÁîü trap Â∞±ËæìÂá∫‰∏Ä‰∏ãÂΩìÂâçÁöÑ scauseÔºàtrap ÂéüÂõ†ÔºâÔºåstvalÔºàÂÖ∑‰ΩìÂèëÁîü trap ÁöÑÊåá‰ª§Âú∞ÂùÄÔºâÔºåsepcÔºàtrap ‰πãÂêéÁöÑËøîÂõûÂú∞ÂùÄÔºâÔºå‰∏ÄÊñπÈù¢ÁúãÁúãÊúâÊ≤°Êúâ trapÔºåÂè¶‰∏ÄÊñπÈù¢Ê†πÊçÆËøô‰∫õÂØÑÂ≠òÂô®ÁöÑÂÄºÁúãÁúã trap ÂèëÁîüÁöÑÂéüÂõ†„ÄÇ
- ÂèØ‰ª•ËßÇÂØüÂà∞Êúâ‰∏Ä‰∫õ <code>while(1)</code> ËØ≠Âè•ÔºåËøôÊòØÂõ†‰∏∫Â¶ÇÊûú‰Ω†ÁöÑÁ®ãÂ∫èÂç°‰ΩèÁöÑÂéüÂõ†ÊòØÂæ™ÁéØÂèëÁîü trapÔºå‰∏Ä‰∏™ trap ËøòÊ≤°ÁªìÊùüÂ∞±ËøõÂÖ•‰∫ÜÂè¶‰∏Ä‰∏™ÔºåÈÇ£ÂèØËÉΩ‰ºöÂæ™ÁéØËæìÂá∫‰Ω†ÊâìÂç∞ÁöÑ‰ø°ÊÅØÁúã‰∏çÊ∏Ö„ÄÇËøô‰∏™ËØ≠Âè•ÂèØ‰ª•Â∏Æ‰Ω†ÂÅú‰ΩèËÆ©‰Ω†ÁúãÊ∏ÖÊâìÂç∞ÁöÑ‰ø°ÊÅØ„ÄÇÔºàÊÄé‰πàÊàëËÆ≤ÂæóÊå∫Ëµ∑Êù•Â•ΩÂº±Êô∫Ôºâ</p>
<p>Â¶ÇÊûúÁ°ÆÂÆûÊòØÂæ™ÁéØ trap ÂØºËá¥ÁöÑÁ®ãÂ∫èÂç°‰ΩèÔºåÈÇ£‰πàÊåâÊâìÂç∞ÁöÑ‰ø°ÊÅØÂéªÊÄùËÄÉÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇÂ¶ÇÊûúËøòÊòØ‰ªÄ‰πàËæìÂá∫ÈÉΩÊ≤°ÊúâÔºàÊàëËÆ∞Âæó‰πüÊúâËøôÁßçÊÉÖÂÜµÔºâÔºåÊàë‰∏çËÆ∞ÂæóÊòØ‰ªÄ‰πàÂéüÂõ†‰∫ÜÔºå‰ΩÜÊòØËµ∑Á†ÅÂ∏Æ‰Ω†ÊéíÈô§‰∫ÜÂèëÁîü‰∫Ü trap ÁöÑÂèØËÉΩÊÄßÔºå‰Ω†ÂèØ‰ª•Âú®Ê≠§Âü∫Á°Ä‰∏äÁªßÁª≠ÊÄùËÄÉÊòØ‰∏∫‰ªÄ‰πà„ÄÇ</p>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            ÂõûÂà∞È°µÈù¢È°∂ÈÉ®
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "navigation.expand", "navigation.top"], "search": "../../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="../../../javascripts/mathjax.js"></script>
        
      
        
          <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        
      
        
          <script src="../../../javascripts/tex-mml-chtml.js"></script>
        
      
    
  </body>
</html>